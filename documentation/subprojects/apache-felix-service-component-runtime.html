<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       https://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
  <head>
    <title>Apache Felix - Apache Felix Service Component Runtime (SCR)</title>
    <link rel="icon" href="/res/favicon.ico">
    <link rel="stylesheet" href="/res/site.css" type="text/css" media="all">
    <link rel="stylesheet" href="/res/codehilite.css" type="text/css" media="all">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </head>
  <body>
    <div class="title">
      <div class="logo">
        <a href="https://felix.apache.org/">
          <img border="0" alt="Apache Felix" src="/res/logo.png">
        </a>
      </div>
      <div class="header">
        <a href="https://www.apache.org/">
          <img border="0" alt="Apache" src="/res/apache.png">
        </a>
      </div>
    </div>
    
    <div class="menu"> 
      <style type="text/css">
/* The following code is added by mdx_elementid.py
   It was originally lifted from http://subversion.apache.org/style/site.css */
/*
 * Hide class="elementid-permalink", except when an enclosing heading
 * has the :hover property.
 */
.headerlink, .elementid-permalink {
  visibility: hidden;
}
h2:hover > .headerlink, h3:hover > .headerlink, h1:hover > .headerlink, h6:hover > .headerlink, h4:hover > .headerlink, h5:hover > .headerlink, dt:hover > .elementid-permalink { visibility: visible }</style>
<p><a href="/news.html">News</a>  <br />
<a href="/license.html">License</a>  <br />
<a href="/downloads.cgi">Downloads</a>  <br />
<a href="/documentation.html">Documentation</a>  <br />
<a href="/mailinglists.html">Mailing Lists</a>  <br />
<a href="/documentation/community/contributing.html">Contributing</a>  <br />
<a href="/sitemap.html">Site Map</a>  <br />
<a href="https://www.apache.org/">ASF</a>  <br />
<a href="https://www.apache.org/security/">Security</a>  <br />
<a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>  <br />
<a href="https://www.apache.org/foundation/thanks.html">Sponsors</a>    </p>
<iframe
    src="https://www.apache.org/ads/button.html"
    style="border-width:0; float: left"
    frameborder="0"
    scrolling="no"
    width="135"
    height="135">
</iframe>
    </div>
    
    <div class="main">
      <div class="breadcrump" style="font-size: 80%;">
        <a href="/">Home</a>&nbsp;&raquo&nbsp;<a href="/documentation.html">Documentation</a>&nbsp;&raquo&nbsp;<a href="/documentation/subprojects.html">Apache Felix Subproject Documentation</a>
      </div>

      <h1>Apache Felix Service Component Runtime (SCR)</h1>
      <style type="text/css">
/* The following code is added by mdx_elementid.py
   It was originally lifted from http://subversion.apache.org/style/site.css */
/*
 * Hide class="elementid-permalink", except when an enclosing heading
 * has the :hover property.
 */
.headerlink, .elementid-permalink {
  visibility: hidden;
}
h2:hover > .headerlink, h3:hover > .headerlink, h1:hover > .headerlink, h6:hover > .headerlink, h4:hover > .headerlink, h5:hover > .headerlink, dt:hover > .elementid-permalink { visibility: visible }</style>
<div class="toc">
<ul>
<li><a href="#example">Example</a><ul>
<li><a href="#component">Component</a></li>
<li><a href="#declaration">Declaration</a></li>
<li><a href="#activation">Activation</a></li>
<li><a href="#service-binding">Service Binding</a></li>
<li><a href="#looking-up-the-service">Looking up the Service</a></li>
<li><a href="#receiving-the-service">Receiving the Service</a></li>
</ul>
</li>
<li><a href="#maven-scr-plugin">Maven SCR Plugin</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#non-standard-component-factory-behaviour">Non-Standard Component Factory Behaviour</a></li>
<li><a href="#administration">Administration</a><ul>
<li><a href="#shell-command">Shell Command</a></li>
<li><a href="#api-use">API Use</a></li>
</ul>
</li>
<li><a href="#summary">Summary</a></li>
</ul>
</div>
<p>The Apache Felix Service Component Runtime described by the OSGi Declarative Services Specification is implemented by the <code>org.apache.felix.scr</code> bundle. As specified, the components must be declared in XML-formatted descriptor files which in turn must be listed in the <code>Service-Component</code> header of the declaring bundle. But the good news is, you usually don't have to worry about XML as you can simply use annotations which are processed at build time. The build tool will create the XML files and headers for you.</p>
<p>The component declarations are read when the declaring bundle is started and the respective components are verified and activated depending on their declaration.</p>
<p>The Apache Felix Declarative Services implementation is the reference implementation for  the OSGi Declarative Services Specification Version 1.3 (R6) and therefore passes the OSGi CT.</p>
<h2 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h2>
<p>To help you get a head start, here is an example of using Declarative Services "by hand". Instead of using annotations, the XML is created by hand. We discourage doing so, but this is just to give you an idea how it really works. You will find more examples in the <code>trunk/examples</code> folder of the Apache Felix Project.</p>
<h3 id="component">Component<a class="headerlink" href="#component" title="Permanent link">&para;</a></h3>
<p>First of all the component must be implemented in a simple Java class. The Declarative Services Specification basically places no restrictions on the contents of this class. If you make use of advanced functionality such as providing an <code>activate()</code> or <code>deactivate()</code> method or using service loopup by <em>event strategy</em> (see 112.3.1 Accessing Services) you will of course have to provide the respective methods.</p>
<p>For the sake of example, lets define a very simple class, which implements a <code>java.util.Comparator</code> service:</p>
<div class="codehilite"><pre><span class="kn">package</span> <span class="n">sample</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Comparator</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleComparator</span> <span class="kd">implements</span> <span class="n">Comparator</span>
<span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span> <span class="n">Object</span> <span class="n">o1</span><span class="o">,</span> <span class="n">Object</span> <span class="n">o2</span> <span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO: calculate the result</span>
        <span class="k">return</span> <span class="n">o1</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span> <span class="n">o2</span> <span class="o">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>This is of course a very simple and not very intelligently implemented comparator...</p>
<h3 id="declaration">Declaration<a class="headerlink" href="#declaration" title="Permanent link">&para;</a></h3>
<p>The next step consists of writing the declaration. I usually put these files in the <code>OSGI-INF</code> folder of the bundle, but the files may be placed anywhere within the bundle or any of the bundle's fragments as long as its path is listed in the <code>Service-Component</code> bundle manifest header.</p>
<p>So here we go with the <code>OSGI-INF/sample.xml</code> file:</p>
<div class="codehilite"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;component</span> <span class="na">name=</span><span class="s">&quot;sample.component&quot;</span> <span class="na">immediate=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;implementation</span> <span class="na">class=</span><span class="s">&quot;sample.SampleComparator&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;service.description&quot;</span> <span class="na">value=</span><span class="s">&quot;Sample Comparator Service&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;service.vendor&quot;</span> <span class="na">value=</span><span class="s">&quot;Apache Software Foundation&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;service&gt;</span>
    <span class="nt">&lt;provide</span> <span class="na">interface=</span><span class="s">&quot;java.util.Comparator&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/service&gt;</span>
<span class="nt">&lt;/component&gt;</span>
</pre></div>


<p>There are some noteworthy settings in this descriptor already:</p>
<ul>
<li><em>name</em> - Uniquely identifies this component and is also used to retrieve optional configuration from the Configuration Admin Service (if available).</li>
<li><em>immediate</em> - Defines whether the component is to be instantiated immediately (<code>true</code>) or on-demand (<code>false</code>).</li>
<li><em>implementation.class</em> - The fully qualified name of the class implementing the component. This class must be public and have a public default constructor for it to be usable by the Service Component Runtime. This class is not required to be exported and may as well be private to the bundle. In fact, you will generally not export the component implementation class.</li>
<li><em>property</em> - These elements define configuration properties to the component. These properties are available through the <code>ComponentContext</code> which is presented to the component in the <code>activate</code> method (see below).</li>
<li><em>service</em> - If the component is to be registered as a service, the service names are listed in <em>provide</em> elements inside the <em>service</em> element. These names will generally be interfaces and must be visible to other bundles for the service to be usable. In this sample, the service is the Java <code>java.util.Comparator</code> class, which is always visible.</li>
</ul>
<p>To finalize this declaration, add the following header to the bundle manifest:</p>
<div class="codehilite"><pre><span class="n">Service</span><span class="o">-</span><span class="n">Component</span><span class="p">:</span> <span class="n">OSGI</span><span class="o">-</span><span class="n">INF</span><span class="o">/</span><span class="n">sample</span><span class="p">.</span><span class="n">xml</span>
</pre></div>


<h3 id="activation">Activation<a class="headerlink" href="#activation" title="Permanent link">&para;</a></h3>
<p>It may well be that the component needs to be notified, when it is activated and deactivated. For this, the component may implement an <code>activate</code> method and a <code>deactivate</code> method. Both methods must be <code>public</code> or <code>protected</code> and take a single argument, the <code>org.osgi.service.ComponentContext</code>. It is recommended for this method to the <code>protected</code> as it is only used by the Service Component Runtime and should of course not be part of the public API of the component.</p>
<p>Here is the initial class extended with activation and deactivation methods:</p>
<div class="codehilite"><pre><span class="kn">package</span> <span class="n">sample</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Comparator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.service.component.ComponentContext</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleComparator</span> <span class="kd">implements</span> <span class="n">Comparator</span>
<span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span> <span class="n">Object</span> <span class="n">o1</span><span class="o">,</span> <span class="n">Object</span> <span class="n">o2</span> <span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO: calculate the result</span>
        <span class="k">return</span> <span class="n">o1</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span> <span class="n">o2</span> <span class="o">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">activate</span><span class="o">(</span><span class="n">ComponentContext</span> <span class="n">context</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO: Do something on activation</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">deactivate</span><span class="o">(</span><span class="n">ComponentContext</span> <span class="n">context</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO: Do something on deactivation</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>Nothing more needs to be done as the Service Component Runtime automatically recognizes and calls these methods.</p>
<h3 id="service-binding">Service Binding<a class="headerlink" href="#service-binding" title="Permanent link">&para;</a></h3>
<p>The next step would probably be to do some service binding. This is somewhat more overhead, as the referred to services must be declared. On the other hand, you do not have to care to listen for these services. As examples of these strategies we will first use the lookup strategy to access an OSGi <code>HttpService</code> and then we will use the event strategy to access an OSGi <code>LogService</code> (I personally prefer the event strategy, but your mileage may vary).</p>
<h3 id="looking-up-the-service">Looking up the Service<a class="headerlink" href="#looking-up-the-service" title="Permanent link">&para;</a></h3>
<p>To use the service, the reference must be declared in the service declaration in an <em>reference</em> element. Here is the respective declaration for a log service to lookup:</p>
<div class="codehilite"><pre><span class="nt">&lt;component...&gt;</span>
   ...
    <span class="nt">&lt;reference</span> <span class="na">name=</span><span class="s">&quot;http&quot;</span>
        <span class="na">interface=</span><span class="s">&quot;org.osgi.service.http.HttpService&quot;</span>
        <span class="na">cardinality=</span><span class="s">&quot;1..1&quot;</span> 
        <span class="na">policy=</span><span class="s">&quot;static&quot;</span>
    <span class="nt">/&gt;</span>
   ...
<span class="nt">&lt;/component&gt;</span>
</pre></div>


<p>To use this service you call the <code>ComponentContext.getService(String)</code> method, for example in the <code>activate</code> method:</p>
<div class="codehilite"><pre><span class="kd">protected</span> <span class="kt">void</span> <span class="nf">activate</span><span class="o">(</span><span class="n">ComponentContext</span> <span class="n">context</span><span class="o">)</span>
<span class="o">{</span>
    <span class="n">HttpService</span> <span class="n">http</span> <span class="o">=</span> <span class="o">(</span> <span class="n">HttpService</span> <span class="o">)</span> <span class="n">context</span><span class="o">.</span><span class="na">locateService</span><span class="o">(</span> <span class="s">&quot;http&quot;</span> <span class="o">);</span>
<span class="o">}</span>
</pre></div>


<h3 id="receiving-the-service">Receiving the Service<a class="headerlink" href="#receiving-the-service" title="Permanent link">&para;</a></h3>
<p>The event strategy works by declaring bind and unbind methods in the component descriptor. These methods take a single parameter of the type defined in the <em>reference.interface</em> attribute and must be declared <code>public</code> or <code>protected</code>. As with the <code>activate</code> and <code>deactive</code> it is recommended for the bind and unbind methods to be declared <code>protected</code> as they are generally not part of the public API of the component.</p>
<p>When using the event strategy, you will want to store the service in a private field of the component for later use.</p>
<p>First here is the reference declaration:</p>
<div class="codehilite"><pre><span class="nt">&lt;component...&gt;</span>
   ...
   <span class="nt">&lt;reference</span> <span class="na">name=</span><span class="s">&quot;log&quot;</span>
         <span class="na">interface=</span><span class="s">&quot;org.osgi.service.log.LogService&quot;</span>
         <span class="na">cardinality=</span><span class="s">&quot;1..1&quot;</span>
         <span class="na">policy=</span><span class="s">&quot;static&quot;</span>
         <span class="na">bind=</span><span class="s">&quot;bindLog&quot;</span>
         <span class="na">unbind=</span><span class="s">&quot;unbindLog&quot;</span>
   <span class="nt">/&gt;</span>
   ...
<span class="nt">&lt;/component&gt;</span>
</pre></div>


<p>And here is some code:</p>
<div class="codehilite"><pre><span class="kd">private</span> <span class="n">LogService</span> <span class="n">log</span><span class="o">;</span>

<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">activate</span><span class="o">(</span><span class="n">ComponentContext</span> <span class="n">context</span><span class="o">)</span>
<span class="o">{</span>
    <span class="n">log</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">LogService</span><span class="o">.</span><span class="na">LOG_INFO</span><span class="o">,</span> <span class="s">&quot;Hello Components!&quot;</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">bindLog</span><span class="o">(</span><span class="n">LogService</span> <span class="n">log</span><span class="o">)</span>
<span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">log</span> <span class="o">=</span> <span class="n">log</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">unbindLog</span><span class="o">(</span><span class="n">LogService</span> <span class="n">log</span><span class="o">)</span>
<span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">log</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>


<p>Note, that you may refer to the <code>log</code> field in the <code>activate</code> method as we declared the reference as required. In this case the reference is provided to the component in the <code>bind</code> method before the <code>activate</code> method is called.</p>
<h2 id="maven-scr-plugin">Maven SCR Plugin<a class="headerlink" href="#maven-scr-plugin" title="Permanent link">&para;</a></h2>
<p>To simplify the tasks of generating the SCR Desriptor and adding the <code>Service-Component</code> header to the bundle manifest, the <a href="/documentation/subprojects/apache-felix-maven-scr-plugin.html">Apache Felix Maven SCR Plugin</a> may be used. This helps keeping the descriptor and the code in sync especially during development.</p>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<p>The Apache Felix Declarative Services implementation can be configured with Framework properties which are read on startup of the implementation bundle and Configuration Admin Service configuraiton which is provided by the Configuration Admin Service to the service PID <code>org.apache.felix.scr.ScrService</code>.</p>
<p>The following properties are supported:</p>
<table class="table">
<thead>
<tr>
<th>Property</th>
<th>Default Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ds.loglevel</code></td>
<td>1</td>
<td>Defines a logging level at which messages are logged. This configuration property is converted to an <code>int</code> number used as the OSGi Log Service logging level.</td>
</tr>
<tr>
<td><code>ds.showtrace</code></td>
<td><code>false</code></td>
<td>sets the log level to <code>debug</code> if set to <code>true</code> and the <code>ds.loglevel</code> cannot be converted to a value log level</td>
</tr>
<tr>
<td><code>ds.showerrors</code></td>
<td><code>true</code></td>
<td>Disables logging completely if set to <code>false</code> and the <code>ds.loglevel</code> cannot be converted to a value log level and the <code>ds.showtrace</code> is not set to <code>true</code></td>
</tr>
<tr>
<td><code>ds.factory.enabled</code></td>
<td><code>false</code></td>
<td>Enables Component Factory functionality not compliant with the Declarative Services 1.1 specification if set to <code>true</code>. Only set this if you really know you need this. See the <em>Non-Standard Component Factory Behaviour</em> section below for more details.</td>
</tr>
<tr>
<td><code>ds.ctworkaround</code></td>
<td><code>false</code></td>
<td>Enables workaround functionality to pass the OSGi CT. Generally this property should not be set to <code>true</code> because it enables behaviour which is not compliant with the Declarative Services 1.1 specification. See <a href="https://issues.apache.org/jira/browse/FELIX-2526">FELIX-2526</a> for details.</td>
</tr>
<tr>
<td><code>ds.delayed.keepInstances</code></td>
<td><code>false</code></td>
<td>Whether or not to keep instances of delayed components once they are not referred to any more. The Declarative Services specifications suggests that instances of delayed components are disposed off if there is not used any longer. Setting this flag causes the components to not be disposed off and thus prevent them from being constantly recreated if often used. Examples of such components may be EventHandler services. The default is to dispose off unused components. See <a href="https://issues.apache.org/jira/browse/FELIX-3039">FELIX-3039</a> for details.</td>
</tr>
</tbody>
</table>
<p>The <code>ds.loglevel</code> property is treated as follows:</p>
<ul>
<li>If the property is a number, the <code>int</code> value of the number is used</li>
<li>If the property is a string parseable to an <code>int</code> the parsed value is used</li>
<li>If the property is any of the strings <em>debug</em>, <em>info</em>, <em>warn</em>, or <em>error</em>, the respective log level of <code>4</code>, <code>3</code>, <code>2</code>, or <code>1</code> is used</li>
<li>Otherwise, unless the <code>ds.showtrace</code> or <code>ds.showerrors</code> property is set, the default value is assumed</li>
</ul>
<p>This configuration mechanism is implemented in the <a href="http://svn.apache.org/repos/asf/felix/trunk/scr/src/main/java/org/apache/felix/scr/impl/config/ScrConfiguration.java">ScrConfiguration</a> and its helper classes.</p>
<h2 id="non-standard-component-factory-behaviour">Non-Standard Component Factory Behaviour<a class="headerlink" href="#non-standard-component-factory-behaviour" title="Permanent link">&para;</a></h2>
<div class="note" markdown="1">
If you don't know what this section is about, just ignore it and leave the <code>ds.factory.enabled</code> configuration property unconfigured.
</div>

<p>Versions of the Apache Felix Declarative Services implementation prior to 1.2.0 supported handling of Component Factory components which is not specification compliant.</p>
<p>This behaviour assumes the component name of the Component Factory component to be Service Factory PID and each configuration with this Service Factory PID causes the service component runtime to actually create and activate an instance of the Component Factory component automatically. This is not foreseen by the specification which defines instantiation of Component Factory components as being purely application controled and not configuration induced.</p>
<p>To have components instantiated with factory configurations, regular components should be used. This case each factory configuration instance will create a component instance.</p>
<p>If you know that you are using Component Factory components depending on this non-standard behaviour you may set the <code>ds.factory.enabled</code> configuration property to <code>true</code> (the default of this property is <code>false</code> thus disabling this functionality for specification compliance).</p>
<p>For details also refer to <a href="https://issues.apache.org/jira/browse/FELIX-1416">FELIX-1416</a></p>
<h2 id="administration">Administration<a class="headerlink" href="#administration" title="Permanent link">&para;</a></h2>
<p>The OSGi Compendium specification defines no administrative API for Declarative Services. As of version 0.9.0-20071123.131249-8 a simple administrative API is provided the Apache Felix implementation. The bundle itself also has a Felix Shell Command providing easy commands to introspect the states of the registered components.</p>
<p>The <a href="/documentation/subprojects/apache-felix-web-console.html">Apache Felix Web Console</a> has built-in support for Declarative Services administration based on this API.</p>
<h3 id="shell-command">Shell Command<a class="headerlink" href="#shell-command" title="Permanent link">&para;</a></h3>
<p>The management API is made available to the Felix Shell as the <code>scr</code> command with a short list of subcommands:</p>
<table class="table">
<thead>
<tr>
<th>Synopsis</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>scr help [ &lt;subcommand&gt; ]()</code></td>
<td>Show help of the specific <code>&lt;subcommand&gt;</code> or list all known subcommands</td>
</tr>
<tr>
<td><code>scr list [ &lt;bundleId&gt; ]()</code></td>
<td>List registered components of the bundle specified by <code>&lt;bundleId&gt;</code> or list all components. Each component is listed with its component ID, the state and the name. <code>&lt;bundleId&gt;</code> man be either the ID of a bundle or the symbolic name of a bundle.</td>
</tr>
<tr>
<td><code>scr info &lt;componentId&gt;</code></td>
<td>Show a complete information dump of the given component. This dump includes the name, status, provided services and information on the service references. <code>&lt;componentId&gt;</code> may be either the ID of a component or the component's name. The component name must be used for disabled components.</td>
</tr>
<tr>
<td><code>scr enable &lt;componentId&gt;</code></td>
<td>Enable the given component if not already enabled. If the component is already destroyed or enabled, this command has no effect. <code>&lt;componentId&gt;</code> may be either the ID of a component or the component's name. The component name must be used for disabled components.</td>
</tr>
<tr>
<td><code>scr disable &lt;componentId&gt;</code></td>
<td>Disable the given component if not already disabled. If the component is already destroyed or disabled, this command has no effect. <code>&lt;componentId&gt;</code> may be either the ID of a component or the component's name. The component name must be used for disabled components.</td>
</tr>
</tbody>
</table>
<p>The administrative API commands are also available in the Gogo shell where the subcommand names must be prefixed with the name space <code>scr</code>. Thus the <code>list</code> command corresponds to <code>scr:list</code> in the Gogo shell.</p>
<h3 id="api-use">API Use<a class="headerlink" href="#api-use" title="Permanent link">&para;</a></h3>
<p>The API consists of the main interface <code>org.apache.felix.scr.ScrService</code> and two helper interfaces <code>org.apache.felix.scr.Component</code> describing a registered component and <code>org.apache.felix.scr.Reference</code> describing a single reference of a registered component. To access the management API, client applications just ask for the <code>ScrService</code> as usual:</p>
<div class="codehilite"><pre><span class="o">....</span>
<span class="n">ServiceReference</span> <span class="n">scrServiceRef</span> <span class="o">=</span> <span class="n">bundleContext</span><span class="o">.</span><span class="na">getServiceReference</span><span class="o">(</span> <span class="n">ScrService</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">);</span>
<span class="n">ScrService</span> <span class="n">scrService</span> <span class="o">=</span> <span class="o">(</span><span class="n">ScrService</span><span class="o">)</span> <span class="n">bundleContext</span><span class="o">.</span><span class="na">getService</span><span class="o">(</span><span class="n">scrServiceRef</span><span class="o">);</span>
<span class="o">....</span>
</pre></div>


<p>Alternatively, you may of course use the <code>ServiceTracker</code> or if you are using the <code>ScrService</code> in a component, you may have the <code>ScrService</code> bound according to the component declaration.</p>
<p>The <code>ScrService</code> allows access to all registered components, to a specific component by component ID or to all registered components of a specific bundle.</p>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>This tutorial just listed some very basic information on Declarative Service. To get more information, for example on how the Configuration Admin Service may be used to configure components, refer to the Declarative Services Sepecification in the OSGi Service Platform <em>Service Compendium</em> book.</p>
<p>Have Fun !</p>
      <div class="timestamp" style="margin-top: 30px; font-size: 80%; text-align: right;">
        Rev. 1741809 by cziegeler on Sat, 30 Apr 2016 20:20:56 +0000
      </div>
      <div class="trademarkFooter"> 
        Apache Felix, Felix, Apache, the Apache feather logo, and the Apache Felix project
        logo are trademarks of The Apache Software Foundation. All other marks mentioned
        may be trademarks or registered trademarks of their respective owners.
      </div>
    </div>
  </body>
</html>
