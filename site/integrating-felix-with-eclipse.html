
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML>
  <HEAD>
    <TITLE>Apache Felix - Integrating Felix with Eclipse</TITLE>
    <LINK rel="stylesheet" href="http://felix.apache.org/site/media.data/site.css" type="text/css" media="all">
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </HEAD>
  <BODY>
    <DIV class="title"><DIV class="logo"><A href="http://felix.apache.org/site/index.html"><IMG border="0" alt="Apache Felix" src="http://felix.apache.org/site/media.data/logo.png"></A></DIV><DIV class="header"><A href="http://www.apache.org/"><IMG border="0" alt="Apache" src="http://felix.apache.org/site/media.data/apache.png"></A></DIV></DIV>
    <DIV class="menu">
<UL>
	<LI><A href="news.html" title="news">news</A></LI>
	<LI><A href="http://www.apache.org/licenses/" class="external-link" rel="nofollow">license</A></LI>
	<LI><A href="http://felix.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">downloads</A></LI>
	<LI><A href="documentation.html" title="documentation">documentation</A></LI>
	<LI><A href="mailinglists.html" title="mailinglists">mailing lists</A></LI>
	<LI><A href="contributing.html" title="Contributing">contributing</A></LI>
	<LI><A href="http://www.apache.org/" class="external-link" rel="nofollow">asf</A></LI>
	<LI><A href="http://www.apache.org/security/" class="external-link" rel="nofollow">security</A></LI>
	<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">sponsorship</A></LI>
	<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link" rel="nofollow">sponsors</A>
<!-- ApacheCon Ad -->
<IFRAME src="http://www.apache.org/ads/button.html" style="border-width:0; float: left" frameborder="0" scrolling="no" width="135" height="135"></IFRAME>
<P style="height: 100px">
<!-- ApacheCon Ad --></LI>
</UL>
    </DIV>
    <DIV class="main">
<H1><A name="IntegratingFelixwithEclipse-IntegratingFelixwithEclipse"></A>Integrating Felix with Eclipse</H1>

<P>This document explains how to launch Felix inside the Eclipse IDE. Then, it is possible to use Eclipse debugging facilities to debug bundles.</P>


<H2><A name="IntegratingFelixwithEclipse-Preliminaries"></A>Preliminaries</H2>

<P>To integrate Felix inside Eclipse, you need Felix, Eclipse and nothing else.</P>

<H3><A name="IntegratingFelixwithEclipse-InstallingEclipse"></A>Installing Eclipse</H3>

<P>First, you need Eclipse. To download the Eclipse IDE, go to:<A href="http://www.eclipse.org/downloads/" class="external-link" rel="nofollow">http://www.eclipse.org/downloads/</A>. This tutorial works for Eclipse 3.X.X, but may works on older version.</P>

<H3><A name="IntegratingFelixwithEclipse-CreationoftheFelixbinaries"></A>Creation of the Felix binaries</H3>

<P>To integrate Felix inside Eclipse, you have three possibilities</P>
<UL>
	<LI>Using Pax Cursor to launch easily any supported OSGi framework inside Eclipse.</LI>
	<LI>Integrating the Felix release as a Java project</LI>
	<LI>Integrating the Felix trunk (latest version) as a Java project</LI>
</UL>


<H4><A name="IntegratingFelixwithEclipse-UsingPaxCursor"></A>Using Pax Cursor</H4>

<P><A href="http://wiki.ops4j.org/confluence/display/ops4j/Pax%20Cursor" class="external-link" rel="nofollow">Pax Cursor</A> is an Eclipse Plugin that adds Eclipse launch configurations for all platforms / versions supported by Pax Runner.</P>

<H4><A name="IntegratingFelixwithEclipse-UsigntheFelixreleaseasaJavaProject"></A>Usign the Felix release as a Java Project</H4>

<P>Once, Eclipse is installed, you need to download Felix. You will find this Felix release on <A href="http://felix.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">http://felix.apache.org/site/downloads.cgi</A>. Choose a binary release in your preferred archive format. Then, unzip the release in a temporary folder. We will copy the files elsewhere later.</P>

<H4><A name="IntegratingFelixwithEclipse-BuildingandUsingtheFelixTrunk"></A>Building and Using the Felix Trunk</H4>

<P>If you want to use the Felix trunk, follows the <A href="http://felix.apache.org/site/building-felix.html" class="external-link" rel="nofollow">instructions</A> to checkout and build it. The Felix binaries are created in the <EM>main</EM> project.  We will copy the files elsewhere later.</P>

<H2><A name="IntegratingFelixwithEclipse-InstallingFelix"></A>Installing Felix</H2>

<P>The integration uses a Java project. This project will contain Felix. This section explains how-to create the new project, how-to copy the Felix release inside the project and finally, how-to configure it.</P>

<H3><A name="IntegratingFelixwithEclipse-CreationoftheFelixJavaproject"></A>Creation of the Felix Java project</H3>

<P>First, launch Eclipse, and select your preferred workspace. The integration will be attached to this workspace.</P>

<P>Then, click on File &#45;&gt; New &#45;&gt; Project... as depicts on the Figure 1.</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/new_project_1.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>1</B></FONT><FONT color="#4f81bd"><B>: Creation of a new project</B></FONT></P>

<P>This action will launch the project creation wizard. Select Java project (Figure 2), and click on &quot;Next&quot;.</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/new_project_2.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>2</B></FONT><FONT color="#4f81bd"><B>: Selection of the project type</B></FONT></P>

<P>Enter the project name (Felix for example). Select the &quot;create separate source and output folders&quot; option (if not already selected). These actions are depicted on the Figure 3. Then click on &quot;Next&quot;.</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/new_project_3.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>3</B></FONT><FONT color="#4f81bd"><B>: Configuration of the Felix project</B></FONT></P>

<P>On this new wizard page, you need only to change the default output folder (Felix/bin) to another (classes for example, as presented on Figure 4).</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/new_project_4.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>4</B></FONT><FONT color="#4f81bd"><B>: Change the &quot;Default output folder&quot;</B></FONT></P>

<P>After that, click on the &quot;Finish&quot; button. You need to see the following structure (Figure 5). Check that the <EM>bin</EM> folder appears.</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/new_project_5.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure 5: Our new Java Project</B></FONT></P>

<H3><A name="IntegratingFelixwithEclipse-CopyingFelixinsidethecreatedproject"></A>Copying Felix inside the created project</H3>

<P>Now, remember where you uncompress the Felix release, or where is the Felix main project. Move these files inside the created project. Override the <EM>bin</EM> folder when asked.</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/copy_1.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>6</B></FONT><FONT color="#4f81bd"><B>: Overwrite the &quot;bin&quot; folder</B></FONT></P>

<P>Once copied, refresh the project. You should see something as presented on the Figure 7.</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/copy_2.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>7</B></FONT><FONT color="#4f81bd"><B>: The Felix project after the copy</B></FONT></P>

<H3><A name="IntegratingFelixwithEclipse-PreparingtheFelixproject"></A>Preparing the Felix project</H3>

<P>The Felix main jar is bin/Felix.jar. So, we need to add this jar in the project build path as presented on Figure 8. Right-click on the felix.jar file and then choose Build Path &#45;&gt; Add to Build Path.</P>


<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/build_path_1.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>8</B></FONT><FONT color="#4f81bd"><B>: Add the felix.jar file to the project build path</B></FONT></P>

<H2><A name="IntegratingFelixwithEclipse-RunFelix"></A>Run Felix</H2>


<H3><A name="IntegratingFelixwithEclipse-CreateaRunconfiguration"></A>Create a Run configuration</H3>

<P>Now, the Felix project is ready. But, we need to configure a <EM>Run</EM>configuration to launch Felix. To achieve this, right-click on the Felix project and select Run As &#45;&gt; Run... (Figure 9)</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/run_1.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>9</B></FONT><FONT color="#4f81bd"><B>: Create a Run configuration to launch Felix</B></FONT></P>

<P>This action launch the Run configuration windows. Create a new Java Application (Right-click on Java Application and select <EM>new</EM>) (Figure 10)</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/run_2.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure 10:</B></FONT> <FONT color="#4f81bd"><B>Create</B></FONT> <FONT color="#4f81bd"><B>a new Java Application</B></FONT></P>

<P>On the configuration wizard, enter a configuration name. Afterward, check the project name (it should be Felix if you choose Felix as project name). Then, Tick the &quot;Include libraries when searching for a main class&quot; option. You should obtain something as presented on the Figure 11.</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/run_3.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>11</B></FONT><FONT color="#4f81bd"><B>: Felix run configuration</B></FONT></P>

<P>Next, click on the &quot;Search&quot; button. Enter &quot;Main&quot; in the text area. In the resulting list, select &quot;Main &ndash; org.apache.felix.main&quot;. Below the list, you should see: &quot;org.apache.felix.main /Felix/bin/felix.jar&quot;. The resulting windows must be similar as the Figure 11.</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/run_4.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>12</B></FONT><FONT color="#4f81bd"><B>: Choose to &quot;good&quot; main class</B></FONT></P>

<P>At that moment, clicks on the &quot;Ok&quot; button. You come back to the Run configuration windows. Apply the configuration (&quot;Apply&quot; button). And click on the &quot;Run&quot; button (Figure 13).</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/run_5.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>13</B></FONT><FONT color="#4f81bd"><B>: The Felix run configuration can be launched</B></FONT></P>

<P><EM>Note:</EM> Newest Felix versions require to set the <TT>felix.config.properties</TT> property. To achieve this, go in the 'arguments' tab and add the following VM arguments:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
-Dfelix.config.properties=file:conf/config.properties
</PRE>
</DIV></DIV>

<H3><A name="IntegratingFelixwithEclipse-FirstExecution"></A>First Execution</H3>

<P>Once launched, you should see in the Eclipse console view:</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/run_6.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>14</B></FONT><FONT color="#4f81bd"><B>: Endly Felix inside Eclipse&#33;</B></FONT></P>

<P>You can use the console as the &quot;normal&quot; Felix console. In fact it is the normal Felix console in color. Enter a profile name as &quot;integration_test&quot; and then use the console normally (Figure 15).</P>

<P>To stop Felix, either type <EM>shutdown</EM> in the console, either clicks on the red square (&quot;terminate&quot;) in the console toolbar.</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/run_7.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>15</B></FONT><FONT color="#4f81bd"><B>: Use the Felix console normally</B></FONT></P>

<H3><A name="IntegratingFelixwithEclipse-RelaunchingFelix"></A>Re-launching Felix</H3>

<P>Once the run configuration for Felix is created (and launched a first time), you can launch Felix directly by clicking on the Run icon and by choosing Felix (Figure 16). Moreover, you can use Eclipse debugging features by launching Felix in debug mode. To achieve this, click on the debug icon and then choose Felix (Figure 17).</P>

<P><EM>Note:</EM> You can launch Felix in profiling mode too, if you have installed TPTP.</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/run_8.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>16</B></FONT><FONT color="#4f81bd"><B>: Launching directly Felix from the icon bar</B></FONT></P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/run_9.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>17</B></FONT><FONT color="#4f81bd"><B>: Launch Felix in debug mode</B></FONT></P>

<H2><A name="IntegratingFelixwithEclipse-FelixConfiguration"></A>Felix Configuration</H2>

<P>Obviously, you can modify the Felix configuration. The Felix configuration file is in the <EM>conf</EM> folder (config.properties). This section presents briefly two modifications. To go further, look at the Felix documentation.</P>

<H3><A name="IntegratingFelixwithEclipse-ConfiguretheFelixcachelocation"></A>Configure the Felix cache location</H3>

<P>Felix store profiles and deployed bundle inside a cache. Normally this cache is located at_$user_home/.felix.&#95; It is possible to change this location in order to clean it quickly.</P>

<P>Open the configuration file. Then, add a new line with felix.cache.dir=cache (Figure 18). Now, when you will start Felix, it will create a new<EM>cache</EM> folder (in your project)(Figure 19). All profiles will be stored in. To clean your cache, just delete the cache directory.</P>

<P><EM>Note: refresh your project; else the folder does not appear.</EM></P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/conf_1.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>18</B></FONT><FONT color="#4f81bd"><B>: Customize the Felix cache location</B></FONT></P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/conf_2.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>19</B></FONT><FONT color="#4f81bd"><B>: The Felix cache inside your project</B></FONT></P>

<H3><A name="IntegratingFelixwithEclipse-Addautostartedbundles"></A>Add auto-started bundles</H3>

<P>Often, you want that Felix deploy automatically some bundles. By modifying the felix.auto.start.1 (or 2), it is possible to configure which bundle will be deployed at startup.</P>

<P>To achieve this, open the configuration file and add your needed bundle path to the felix.auto.start.1 property (Figure 20). Be careful to the / in your path, to the \ at the end of the line, and to leave a space to the beginning of a new line.</P>

<P><SPAN class="image-wrap" style=""><IMG src="integrating-felix-with-eclipse.data/conf_3.png" style="border: 0px solid black"></SPAN><BR>
<FONT color="#4f81bd"><B>Figure</B></FONT><FONT color="#4f81bd"> <B>20</B></FONT><FONT color="#4f81bd"><B>: Add auto-started bundles</B></FONT></P>

<H2><A name="IntegratingFelixwithEclipse-Debuggingbundles"></A>Debugging bundles</H2>

<P>Now that we are able to launch Felix as a Java Application, we can use the debugging and profiling features of Eclipse. To debug bundles, create a new project for your bundle. Then develop your bundle normally. Afterward, compile / package your bundle to obtain the bundle Jar file. You can use Eclipse PDE, Maven, BND, iPOJO, etc... to package your bundle.</P>

<P>To debug, your code, first place a breakpoint inside your code. Launch Felix in debug mode. Then deploy your bundle Jar file. When the execution reaches the breakpoint, Eclipse opens the debug perspective. You can use all debugging features normally.</P>

<H2><A name="IntegratingFelixwithEclipse-Conclusion"></A>Conclusion</H2>

<P>This document has presented how-to integrate Felix inside Eclipse. For any questions or feedback, subscribe to the Felix users mailing list by sending a message to <A href="mailto:users-subscribe@felix.apache.org" class="external-link" rel="nofollow">users-subscribe@felix.apache.org</A>; after subscribing, email questions or feedback to <A href="mailto:users@felix.apache.org" class="external-link" rel="nofollow">users@felix.apache.org</A>.</P>
        <DIV class="timestamp" style="margin-top: 30px; font-size: 80%; text-align: right;">
Last modified by heavy@ungoverned.org on 2008-10-23 07:03:53.0
        </DIV>
        <DIV class="trademarkFooter">
Apache Felix, Felix, Apache, the Apache feather logo, and the Apache Felix project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
        </DIV>
    </DIV>
  </BODY>
</HTML>
