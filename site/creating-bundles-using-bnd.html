
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML>
  <HEAD>
    <TITLE>Apache Felix - Creating Bundles Using BND</TITLE>
    <LINK rel="stylesheet" href="http://felix.apache.org/site/media.data/site.css" type="text/css" media="all">
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </HEAD>
  <BODY>
    <DIV class="title"><DIV class="logo"><A href="http://felix.apache.org/site/index.html"><IMG border="0" alt="Apache Felix" src="http://felix.apache.org/site/media.data/logo.png"></A></DIV><DIV class="header"><A href="http://www.apache.org/"><IMG border="0" alt="Apache" src="http://felix.apache.org/site/media.data/apache.png"></A></DIV></DIV>
    <DIV class="menu">
<UL>
	<LI><A href="news.html" title="news">news</A></LI>
	<LI><A href="http://www.apache.org/licenses/" class="external-link" rel="nofollow">license</A></LI>
	<LI><A href="http://felix.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">downloads</A></LI>
	<LI><A href="documentation.html" title="documentation">documentation</A></LI>
	<LI><A href="mailinglists.html" title="mailinglists">mailing lists</A></LI>
	<LI><A href="contributing.html" title="Contributing">contributing</A></LI>
	<LI><A href="http://www.apache.org/" class="external-link" rel="nofollow">asf</A></LI>
	<LI><A href="http://www.apache.org/security/" class="external-link" rel="nofollow">security</A></LI>
	<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">sponsorship</A></LI>
	<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link" rel="nofollow">sponsors</A>
<!-- ApacheCon Ad -->
<IFRAME src="http://www.apache.org/ads/button.html" style="border-width:0; float: left" frameborder="0" scrolling="no" width="135" height="135"></IFRAME>
<P style="height: 100px">
<!-- ApacheCon Ad --></LI>
</UL>
    </DIV>
    <DIV class="main">
<H5><A name="CreatingBundlesUsingBND-Purpose"></A>Purpose</H5>

<P>Provide the list of steps required to create a library bundle by wrapping the library jar using bnd (<A href="http://www.aqute.biz/Code/Bnd" class="external-link" rel="nofollow">http://www.aqute.biz/Code/Bnd</A>).</P>

<H5><A name="CreatingBundlesUsingBND-Steps"></A>Steps</H5>

<OL>
	<LI>Use bnd to analyze the library jar (e.g., java -jar bnd-0.0.jar print path/to/FOO.jar)</LI>
	<LI>At the bottom of the bnd output, look for &quot;Unresolved references to ...&quot; which identify package dependencies. If found,<BR>
  a. Identifiy the library jars that provide the missing packages <BR>
  b. Recursively use this process on each dependency </LI>
	<LI>Create a directory that will be the project directory for the bundle (e.g., mkdir FOO-osgi)</LI>
	<LI>Copy the template pom.xml file to the bundle's project directory</LI>
	<LI>Edit the pom.xml file to tailor it for the library jar. Specifically,<BR>
  a. change artifactId <BR>
  b. verify description <BR>
  c. change version <BR>
  d. change FOO's library jar dependency (groupId, artifactId) <BR>
  e. add any other dependencies (from step 2b) <BR>
  f. change Export-Package <BR>
  g. change Private-Package or delete it if it's not needed<BR>
  h. All packages listed in step 1 should be in either Export-Package or Private-Package. Use the library's javadoc to identify the exported packages. The remaining packages should be private.</LI>
	<LI>Run &quot;mvn package&quot; to in the project directory to create the bundle</LI>
	<LI>Use bnd to verify the bundle's contents (e.g., java -jar bnd-0.0.jar print target/FOO-osgi-VERSION.jar)</LI>
	<LI>Run &quot;mvn install&quot; to install the bundle in the local repository</LI>
</OL>


<H5><A name="CreatingBundlesUsingBND-ExamplePOM"></A>Example POM</H5>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
&lt;project
  xmlns=<SPAN class="code-quote">&quot;http://maven.apache.org/POM/4.0.0&quot;</SPAN>
  <SPAN class="code-keyword">xmlns:xsi</SPAN>=<SPAN class="code-quote">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</SPAN>
  xsi:schemaLocation=<SPAN class="code-quote">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;</SPAN>&gt;

  <SPAN class="code-tag">&lt;modelVersion&gt;</SPAN>4.0.0<SPAN class="code-tag">&lt;/modelVersion&gt;</SPAN>
  <SPAN class="code-tag">&lt;groupId&gt;</SPAN>org.apache.felix.commons<SPAN class="code-tag">&lt;/groupId&gt;</SPAN>
  <SPAN class="code-tag">&lt;artifactId&gt;</SPAN>FOO-osgi<SPAN class="code-tag">&lt;/artifactId&gt;</SPAN>
  <SPAN class="code-tag">&lt;name&gt;</SPAN>${pom.artifactId} bundle<SPAN class="code-tag">&lt;/name&gt;</SPAN>
  <SPAN class="code-tag">&lt;description&gt;</SPAN>
    This bundle simply wraps FOO-${pom.version}.jar.
  <SPAN class="code-tag">&lt;/description&gt;</SPAN>
  <SPAN class="code-tag">&lt;version&gt;</SPAN>X.Y<SPAN class="code-tag">&lt;/version&gt;</SPAN>
  <SPAN class="code-tag">&lt;packaging&gt;</SPAN>bundle<SPAN class="code-tag">&lt;/packaging&gt;</SPAN>

  <SPAN class="code-tag">&lt;organization&gt;</SPAN> 
    <SPAN class="code-tag">&lt;name&gt;</SPAN>Apache Felix Project<SPAN class="code-tag">&lt;/name&gt;</SPAN> 
    <SPAN class="code-tag">&lt;url&gt;</SPAN>http://felix.apache.org/<SPAN class="code-tag">&lt;/url&gt;</SPAN> 
  <SPAN class="code-tag">&lt;/organization&gt;</SPAN>

  <SPAN class="code-tag">&lt;dependencies&gt;</SPAN>
    <SPAN class="code-tag">&lt;dependency&gt;</SPAN>
      <SPAN class="code-tag">&lt;groupId&gt;</SPAN>FOO<SPAN class="code-tag">&lt;/groupId&gt;</SPAN>
      <SPAN class="code-tag">&lt;artifactId&gt;</SPAN>FOO<SPAN class="code-tag">&lt;/artifactId&gt;</SPAN>
      <SPAN class="code-tag">&lt;version&gt;</SPAN>${pom.version}<SPAN class="code-tag">&lt;/version&gt;</SPAN>
    <SPAN class="code-tag">&lt;/dependency&gt;</SPAN>
  <SPAN class="code-tag">&lt;/dependencies&gt;</SPAN>

  <SPAN class="code-tag">&lt;build&gt;</SPAN>
    <SPAN class="code-tag">&lt;plugins&gt;</SPAN>
      <SPAN class="code-tag">&lt;plugin&gt;</SPAN>
        <SPAN class="code-tag">&lt;groupId&gt;</SPAN>org.apache.felix<SPAN class="code-tag">&lt;/groupId&gt;</SPAN>
        <SPAN class="code-tag">&lt;artifactId&gt;</SPAN>maven-bundle-plugin<SPAN class="code-tag">&lt;/artifactId&gt;</SPAN>
        <SPAN class="code-tag">&lt;extensions&gt;</SPAN>true<SPAN class="code-tag">&lt;/extensions&gt;</SPAN>
        <SPAN class="code-tag">&lt;configuration&gt;</SPAN>
          <SPAN class="code-tag">&lt;instructions&gt;</SPAN>
            <SPAN class="code-tag">&lt;Bundle-SymbolicName&gt;</SPAN>${pom.artifactId}<SPAN class="code-tag">&lt;/Bundle-SymbolicName&gt;</SPAN>
            <SPAN class="code-tag">&lt;Export-Package&gt;</SPAN>FOO<SPAN class="code-tag">&lt;/Export-Package&gt;</SPAN>
            <SPAN class="code-tag">&lt;Private-Package&gt;</SPAN>FOO.impl<SPAN class="code-tag">&lt;/Private-Package&gt;</SPAN>
          <SPAN class="code-tag">&lt;/instructions&gt;</SPAN>
        <SPAN class="code-tag">&lt;/configuration&gt;</SPAN>
      <SPAN class="code-tag">&lt;/plugin&gt;</SPAN>
    <SPAN class="code-tag">&lt;/plugins&gt;</SPAN>
  <SPAN class="code-tag">&lt;/build&gt;</SPAN>

<SPAN class="code-tag">&lt;/project&gt;</SPAN>
</PRE>
</DIV></DIV>

<H5><A name="CreatingBundlesUsingBND-Resources"></A>Resources</H5>

<P>Bnd - Bundle Tool
<A href="http://www.aqute.biz/Code/Bnd" class="external-link" rel="nofollow">http://www.aqute.biz/Code/Bnd</A></P>

<P>Bundle Plugin for Maven
<A href="http://felix.apache.org/site/maven-bundle-plugin-bnd.html" class="external-link" rel="nofollow">http://felix.apache.org/site/maven-bundle-plugin-bnd.html</A></P>
        <DIV class="timestamp" style="margin-top: 30px; font-size: 80%; text-align: right;">
Last modified by mcculls on 2007-12-07 08:21:38.0
        </DIV>
        <DIV class="trademarkFooter">
Apache Felix, Felix, Apache, the Apache feather logo, and the Apache Felix project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
        </DIV>
    </DIV>
  </BODY>
</HTML>
