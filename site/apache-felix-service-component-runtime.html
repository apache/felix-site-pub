
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML>
  <HEAD>
    <TITLE>Apache Felix - Apache Felix Service Component Runtime</TITLE>
    <LINK rel="stylesheet" href="http://felix.apache.org/site/media.data/site.css" type="text/css" media="all">
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </HEAD>
  <BODY>
    <DIV class="title"><DIV class="logo"><A href="http://felix.apache.org/site/index.html"><IMG border="0" alt="Apache Felix" src="http://felix.apache.org/site/media.data/logo.png"></A></DIV><DIV class="header"><A href="http://www.apache.org/"><IMG border="0" alt="Apache" src="http://felix.apache.org/site/media.data/apache.png"></A></DIV></DIV>
    <DIV class="menu">
<UL>
	<LI><A href="news.html" title="news">news</A></LI>
	<LI><A href="http://www.apache.org/licenses/" class="external-link" rel="nofollow">license</A></LI>
	<LI><A href="http://felix.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">downloads</A></LI>
	<LI><A href="documentation.html" title="documentation">documentation</A></LI>
	<LI><A href="mailinglists.html" title="mailinglists">mailing lists</A></LI>
	<LI><A href="contributing.html" title="Contributing">contributing</A></LI>
	<LI><A href="http://www.apache.org/" class="external-link" rel="nofollow">asf</A></LI>
	<LI><A href="http://www.apache.org/security/" class="external-link" rel="nofollow">security</A></LI>
	<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">sponsorship</A></LI>
	<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link" rel="nofollow">sponsors</A>
<!-- ApacheCon Ad -->
<IFRAME src="http://www.apache.org/ads/button.html" style="border-width:0; float: left" frameborder="0" scrolling="no" width="135" height="135"></IFRAME>
<P style="height: 100px">
<!-- ApacheCon Ad --></LI>
</UL>
    </DIV>
    <DIV class="main">
<DIV>[ <A href="#ApacheFelixServiceComponentRuntime-Example">Example</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-Component">Component</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-Declaration">Declaration</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-Activation">Activation</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-ServiceBinding">Service Binding</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-LookinguptheService">Looking up the Service</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-ReceivingtheService">Receiving the Service</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-MavenSCRPlugin">Maven SCR Plugin</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-Configuration">Configuration</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-NonStandardComponentFactoryBehaviour">Non-Standard Component Factory Behaviour</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-Administration">Administration</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-ShellCommand">Shell Command</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-APIUse">API Use</A> ] [ <A href="#ApacheFelixServiceComponentRuntime-Summary">Summary</A> ]</DIV>

<P>The Apache Felix Service Component Runtime described by the OSGi Declarative Services Specification is implemented by the <TT>org.apache.felix.scr</TT> bundle. As specified, the components must be declared in XML-formatted descriptor files which in turn must be listed in the <TT>Service-Component</TT> header of the declaring bundle.</P>

<P>The component declarations are read when the declaring bundle is started and the respective components are verified and activated depending on their declaration.</P>

<P>The Apache Felix Declarative Services implementation with the OSGi Declarative Services Specification Version 1.1  passes the OSGi CT.</P>

<H2><A name="ApacheFelixServiceComponentRuntime-Example"></A>Example</H2>

<P>To help you get a head start, here is an example of using Declarative Services. You will find more examples in the <TT>trunk/examples</TT> folder of the Apache Felix Project.</P>

<H2><A name="ApacheFelixServiceComponentRuntime-Component"></A>Component</H2>

<P>First of all the component must be implemented in a simple Java class. The Declarative Services Specification basically places no restrictions on the contents of this class. If you make use of advanced functionality such as providing an <TT>activate()</TT> or <TT>deactivate()</TT> method or using service loopup by <EM>event strategy</EM> (see 112.3.1 Accessing Services) you will of course have to provide the respective methods.</P>

<P>For the sake of example, lets define a very simple class, which implements a <TT>java.util.Comparator</TT> service:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>sample/SampleComparator.java</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-java">
<SPAN class="code-keyword">package</SPAN> sample;
<SPAN class="code-keyword">import</SPAN> java.util.Comparator;
<SPAN class="code-keyword">public</SPAN> class SampleComparator <SPAN class="code-keyword">implements</SPAN> Comparator
{
    <SPAN class="code-keyword">public</SPAN> <SPAN class="code-object">int</SPAN> compare( <SPAN class="code-object">Object</SPAN> o1, <SPAN class="code-object">Object</SPAN> o2 )
    {
        <SPAN class="code-comment">// TODO: calculate the result
</SPAN>        <SPAN class="code-keyword">return</SPAN> o1.equals( o2 ) ? 0 : -1;
    }
}
</PRE>
</DIV></DIV>

<P>This is of course a very simple and not very intelligently implemented comparator...</P>

<H2><A name="ApacheFelixServiceComponentRuntime-Declaration"></A>Declaration</H2>

<P>The next step consists of writing the declaration. I usually put these files in the <TT>OSGI-INF</TT> folder of the bundle, but the files may be placed anywhere within the bundle or any of the bundle's fragments as long as its path is listed in the <TT>Service-Component</TT> bundle manifest header.</P>

<P>So here we go with the file:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>OSGI-INF/sample.xml</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-java">
&lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN> encoding=<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>?&gt;
&lt;component name=<SPAN class="code-quote">&quot;sample.component&quot;</SPAN> immediate=<SPAN class="code-quote">&quot;<SPAN class="code-keyword">true</SPAN>&quot;</SPAN>&gt;
  &lt;implementation class=<SPAN class="code-quote">&quot;sample.SampleComparator&quot;</SPAN> /&gt;
  &lt;property name=<SPAN class="code-quote">&quot;service.description&quot;</SPAN> value=<SPAN class="code-quote">&quot;Sample Comparator Service&quot;</SPAN> /&gt;
  &lt;property name=<SPAN class="code-quote">&quot;service.vendor&quot;</SPAN> value=<SPAN class="code-quote">&quot;Apache Software Foundation&quot;</SPAN> /&gt;
  &lt;service&gt;
    &lt;provide <SPAN class="code-keyword">interface</SPAN>=<SPAN class="code-quote">&quot;java.util.Comparator&quot;</SPAN> /&gt;
  &lt;/service&gt;
&lt;/component&gt;
</PRE>
</DIV></DIV>

<P>There are some noteworthy settings in this descriptor already:</P>

<UL>
	<LI><B>name</B> - Uniquely identifies this component and is also used to retrieve optional configuration from the Configuration Admin Service (if available).</LI>
	<LI><B>immediate</B> - Defines whether the component is to be instantiated immediately (<TT>true</TT>) or on-demand (<TT>false</TT>).</LI>
	<LI><B>implementation.class</B> - The fully qualified name of the class implementing the component. This class must be public and have a public default constructor for it to be usable by the Service Component Runtime. This class is not required to be exported and may as well be private to the bundle. In fact, you will generally not export the component implementation class.</LI>
	<LI><B>property</B> - These elements define configuration properties to the component. These properties are available through the <TT>ComponentContext</TT> which is presented to the component in the <TT>activate</TT> method (see below).</LI>
	<LI><B>service</B> - If the component is to be registered as a service, the service names are listed in <B>provide</B> elements inside the <B>service</B> element. These names will generally be interfaces and must be visible to other bundles for the service to be usable. In this sample, the service is the Java <TT>java.util.Comparator</TT> class, which is always visible.</LI>
</UL>


<P>To finalize this declaration, add the following header to the bundle manifest:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
Service-Component: OSGI-INF/sample.xml
</PRE>
</DIV></DIV>

<H2><A name="ApacheFelixServiceComponentRuntime-Activation"></A>Activation</H2>

<P>It may well be that the component needs to be notified, when it is activated and deactivated. For this, the component may implement an <TT>activate</TT> method and a <TT>deactivate</TT> method. Both methods must be <TT>public</TT> or <TT>protected</TT> and take a single argument, the <TT>org.osgi.service.ComponentContext</TT>. It is recommended for this method to the <TT>protected</TT> as it is only used by the Service Component Runtime and should of course not be part of the public API of the component.</P>

<P>Here is the initial class extended with activation and deactivation methods:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>sample/SampleComparator.java</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-java">
<SPAN class="code-keyword">package</SPAN> sample;
<SPAN class="code-keyword">import</SPAN> java.util.Comparator;
<SPAN class="code-keyword">import</SPAN> org.osgi.service.component.ComponentContext;
<SPAN class="code-keyword">public</SPAN> class SampleComparator <SPAN class="code-keyword">implements</SPAN> Comparator
{
    <SPAN class="code-keyword">public</SPAN> <SPAN class="code-object">int</SPAN> compare( <SPAN class="code-object">Object</SPAN> o1, <SPAN class="code-object">Object</SPAN> o2 )
    {
        <SPAN class="code-comment">// TODO: calculate the result
</SPAN>        <SPAN class="code-keyword">return</SPAN> o1.equals( o2 ) ? 0 : -1;
    }

    <SPAN class="code-keyword">protected</SPAN> void activate(ComponentContext context)
    {
        <SPAN class="code-comment">// TODO: Do something on activation
</SPAN>    }
    
    <SPAN class="code-keyword">protected</SPAN> void deactivate(ComponentContext context)
    {
        <SPAN class="code-comment">// TODO: Do something on deactivation
</SPAN>    }
}
</PRE>
</DIV></DIV>

<P>Nothing more needs to be done as the Service Component Runtime automatically recognizes and calls these methods.</P>

<H2><A name="ApacheFelixServiceComponentRuntime-ServiceBinding"></A>Service Binding</H2>

<P>The next step would probably be to do some service binding. This is somewhat more overhead, as the referred to services must be declared. On the other hand, you do not have to care to listen for these services. As examples of these strategies we will first use the lookup strategy to access an OSGi <TT>HttpService</TT> and then we will use the event strategy to access an OSGi <TT>LogService</TT> (I personally prefer the event strategy, but your mileage may vary).</P>

<H3><A name="ApacheFelixServiceComponentRuntime-LookinguptheService"></A>Looking up the Service</H3>

<P>To use the service, the reference must be declared in the service declaration in an <B>reference</B> element. Here is the respective declaration for a log service to lookup:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>LogService Reference</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-java">
&lt;component...&gt;
   ...
    &lt;reference name=<SPAN class="code-quote">&quot;http&quot;</SPAN>
        <SPAN class="code-keyword">interface</SPAN>=<SPAN class="code-quote">&quot;org.osgi.service.http.HttpService&quot;</SPAN>
        cardinality=<SPAN class="code-quote">&quot;1..1&quot;</SPAN> 
        policy=<SPAN class="code-quote">&quot;<SPAN class="code-keyword">static</SPAN>&quot;</SPAN>
    /&gt;
   ...
&lt;/component&gt;
</PRE>
</DIV></DIV>

<P>To use this service you call the <TT>ComponentContext.getService(String)</TT> method, for example in the <TT>activate</TT> method:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
<SPAN class="code-keyword">protected</SPAN> void activate(ComponentContext context)
{
    HttpService http = ( HttpService ) context.locateService( <SPAN class="code-quote">&quot;http&quot;</SPAN> );
}
</PRE>
</DIV></DIV>

<H3><A name="ApacheFelixServiceComponentRuntime-ReceivingtheService"></A>Receiving the Service</H3>

<P>The event strategy works by declaring bind and unbind methods in the component descriptor. These methods take a single parameter of the type defined in the <B>reference.interface</B> attribute and must be declared <TT>public</TT> or <TT>protected</TT>. As with the <TT>activate</TT> and <TT>deactive</TT> it is recommended for the bind and unbind methods to be declared <TT>protected</TT> as they are generally not part of the public API of the component.</P>

<P>When using the event strategy, you will want to store the service in a private field of the component for later use.</P>

<P>First here is the reference declaration:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeHeader panelHeader" style="border-bottom-width: 1px;"><B>LogService Reference</B></DIV><DIV class="codeContent panelContent">
<PRE class="code-java">
&lt;component...&gt;
   ...
   &lt;reference name=<SPAN class="code-quote">&quot;log&quot;</SPAN>
         <SPAN class="code-keyword">interface</SPAN>=<SPAN class="code-quote">&quot;org.osgi.service.log.LogService&quot;</SPAN>
         cardinality=<SPAN class="code-quote">&quot;1..1&quot;</SPAN>
         policy=<SPAN class="code-quote">&quot;<SPAN class="code-keyword">static</SPAN>&quot;</SPAN>
         bind=<SPAN class="code-quote">&quot;bindLog&quot;</SPAN>
         unbind=<SPAN class="code-quote">&quot;unbindLog&quot;</SPAN>
   /&gt;
   ...
&lt;/component&gt;
</PRE>
</DIV></DIV>

<P>And here is some code:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
<SPAN class="code-keyword">private</SPAN> LogService log;

<SPAN class="code-keyword">protected</SPAN> void activate(ComponentContext context)
{
    log.log(LogService.LOG_INFO, <SPAN class="code-quote">&quot;Hello Components!&quot;</SPAN>);
}

<SPAN class="code-keyword">protected</SPAN> void bindLog(LogService log)
{
    <SPAN class="code-keyword">this</SPAN>.log = log;
}

<SPAN class="code-keyword">protected</SPAN> void unbindLog(LogService log)
{
    <SPAN class="code-keyword">this</SPAN>.log = <SPAN class="code-keyword">null</SPAN>;
}
</PRE>
</DIV></DIV>

<P>Note, that you may refer to the <TT>log</TT> field in the <TT>activate</TT> method as we declared the reference as required. In this case the reference is provided to the component in the <TT>bind</TT> method before the <TT>activate</TT> method is called.</P>


<H2><A name="ApacheFelixServiceComponentRuntime-MavenSCRPlugin"></A>Maven SCR Plugin</H2>

<P>To simplify the tasks of generating the SCR Desriptor and adding the <TT>Service-Component</TT> header to the bundle manifest, the <A href="apache-felix-maven-scr-plugin.html" title="Apache Felix Maven SCR Plugin">Apache Felix Maven SCR Plugin</A> may be used. This helps keeping the descriptor and the code in sync especially during development.</P>


<H2><A name="ApacheFelixServiceComponentRuntime-Configuration"></A>Configuration</H2>

<P>The Apache Felix Declarative Services implementation can be configured with Framework properties which are read on startup of the implementation bundle and Configuration Admin Service configuraiton which is provided by the Configuration Admin Service to the service PID <TT>org.apache.felix.scr.ScrService</TT>.</P>

<P>The following properties are supported:</P>

<DIV class="table-wrap">
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh"> Property </TH>
<TH class="confluenceTh"> Default Value </TH>
<TH class="confluenceTh"> Description </TH>
</TR>
<TR>
<TD class="confluenceTd"> <TT>ds.loglevel</TT> </TD>
<TD class="confluenceTd"> 1 </TD>
<TD class="confluenceTd"> Defines a logging level at which messages are logged. This configuration property is converted to an <TT>int</TT> number used as the OSGi Log Service logging level.
<UL>
	<LI>If the property is a number, the <TT>int</TT> value of the number is used</LI>
	<LI>If the property is a string parseable to an <TT>int</TT> the parsed value is used</LI>
	<LI>If the property is any of the strings <EM>debug</EM>, <EM>info</EM>, <EM>warn</EM>, or <EM>error</EM>, the respective log level of <TT>4</TT>, <TT>3</TT>, <TT>2</TT>, or <TT>1</TT> is used.</LI>
	<LI>Otherwise, unless the <TT>ds.showtrace</TT> or <TT>ds.showerrors</TT> property is set, the default value is assumed</LI>
</UL>
</TD>
</TR>
<TR>
<TD class="confluenceTd"> <TT>ds.showtrace</TT> </TD>
<TD class="confluenceTd"> <TT>false</TT> </TD>
<TD class="confluenceTd"> sets the log level to <TT>debug</TT> if set to <TT>true</TT> and the <TT>ds.loglevel</TT> cannot be converted to a value log level </TD>
</TR>
<TR>
<TD class="confluenceTd"> <TT>ds.showerrors</TT> </TD>
<TD class="confluenceTd"> <TT>true</TT> </TD>
<TD class="confluenceTd"> Disables logging completely if set to <TT>false</TT> and the <TT>ds.loglevel</TT> cannot be converted to a value log level and the <TT>ds.showtrace</TT> is not set to <TT>true</TT> </TD>
</TR>
<TR>
<TD class="confluenceTd"> <TT>ds.factory.enabled</TT> </TD>
<TD class="confluenceTd"> <TT>false</TT> </TD>
<TD class="confluenceTd"> Enables Component Factory functionality not compliant with the Declarative Services 1.1 specification if set to <TT>true</TT>. Only set this if you really know you need this. See the <EM>Non-Standard Component Factory Behaviour</EM> section below for more details. </TD>
</TR>
<TR>
<TD class="confluenceTd"> <TT>ds.ctworkaround</TT> </TD>
<TD class="confluenceTd"> <TT>false</TT> </TD>
<TD class="confluenceTd"> Enables workaround functionality to pass the OSGi CT. Generally this property should not be set to <TT>true</TT> because it enables behaviour which is not compliant with the Declarative Services 1.1 specification. See <A href="https://issues.apache.org/jira/browse/FELIX-2526" class="external-link" rel="nofollow">FELIX-2526</A> for details. </TD>
</TR>
<TR>
<TD class="confluenceTd"> <TT>ds.delayed.keepInstances</TT> </TD>
<TD class="confluenceTd"> <TT>false</TT> </TD>
<TD class="confluenceTd"> Whether or not to keep instances of delayed components once they are not referred to any more. The Declarative Services specifications suggests that instances of delayed components are disposed off if there is not used any longer. Setting this flag causes the components to not be disposed off and thus prevent them from being constantly recreated if often used. Examples of such components may be EventHandler services. The default is to dispose off unused components. See <A href="https://issues.apache.org/jira/browse/FELIX-3039" class="external-link" rel="nofollow">FELIX-3039</A> for details. </TD>
</TR>
</TBODY></TABLE>
</DIV>


<P>This configuration mechanism is implemented in the <A href="http://svn.apache.org/repos/asf/felix/trunk/scr/src/main/java/org/apache/felix/scr/impl/config/ScrConfiguration.java" class="external-link" rel="nofollow">ScrConfiguration</A> and its helper classes.</P>


<H2><A name="ApacheFelixServiceComponentRuntime-NonStandardComponentFactoryBehaviour"></A>Non-Standard Component Factory Behaviour</H2>

<DIV class="panelMacro"><TABLE class="noteMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>If you don't know what this section is about, just ignore it and leave the <TT>ds.factory.enabled</TT> configuration property unconfigured.</TD></TR></TABLE></DIV>

<P>Versions of the Apache Felix Declarative Services implementation prior to 1.2.0 supported handling of Component Factory components which is not specification compliant.</P>

<P>This behaviour assumes the component name of the Component Factory component to be Service Factory PID and each configuration with this Service Factory PID causes the service component runtime to actually create and activate an instance of the Component Factory component automatically. This is not foreseen by the specification which defines instantiation of Component Factory components as being purely application controled and not configuration induced.</P>

<P>To have components instantiated with factory configurations, regular components should be used. This case each factory configuration instance will create a component instance.</P>

<P>If you know that you are using Component Factory components depending on this non-standard behaviour you may set the <TT>ds.factory.enabled</TT> configuration property to <TT>true</TT> (the default of this property is <TT>false</TT> thus disabling this functionality for specification compliance).</P>

<P>For details also refer to <A href="https://issues.apache.org/jira/browse/FELIX-1416" class="external-link" rel="nofollow">FELIX-1416</A></P>


<H2><A name="ApacheFelixServiceComponentRuntime-Administration"></A>Administration</H2>

<P>The OSGi Compendium specification defines no administrative API for Declarative Services. As of version 0.9.0-20071123.131249-8 a simple administrative API is provided the Apache Felix implementation. The bundle itself also has a Felix Shell Command providing easy commands to introspect the states of the registered components.</P>

<P>The <A href="apache-felix-web-console.html" title="Apache Felix Web Console">Apache Felix Web Console</A> has built-in support for Declarative Services administration based on this API.</P>


<H3><A name="ApacheFelixServiceComponentRuntime-ShellCommand"></A>Shell Command</H3>

<P>The management API is made available to the Felix Shell as the <TT>scr</TT> command with a short list of subcommands:</P>

<DIV class="table-wrap">
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh"> Synopsis </TH>
<TH class="confluenceTh"> Description </TH>
</TR>
<TR>
<TD class="confluenceTd"> <TT>scr help [ &lt;subcommand&gt; ]</TT> </TD>
<TD class="confluenceTd"> Show help of the specific <TT>&lt;subcommand&gt;</TT> or list all known subcommands </TD>
</TR>
<TR>
<TD class="confluenceTd"> <TT>scr list [ &lt;bundleId&gt; ]</TT> </TD>
<TD class="confluenceTd"> List registered components of the bundle specified by <TT>&lt;bundleId&gt;</TT> or list all components. Each component is listed with its component ID, the state and the name. <TT>&lt;bundleId&gt;</TT> man be either the ID of a bundle or the symbolic name of a bundle. </TD>
</TR>
<TR>
<TD class="confluenceTd"> <TT>scr info &lt;componentId&gt;</TT> </TD>
<TD class="confluenceTd"> Show a complete information dump of the given component. This dump includes the name, status, provided services and information on the service references. <TT>&lt;componentId&gt;</TT> may be either the ID of a component or the component's name. The component name must be used for disabled components. </TD>
</TR>
<TR>
<TD class="confluenceTd"> <TT>scr enable &lt;componentId&gt;</TT> </TD>
<TD class="confluenceTd"> Enable the given component if not already enabled. If the component is already destroyed or enabled, this command has no effect. <TT>&lt;componentId&gt;</TT> may be either the ID of a component or the component's name. The component name must be used for disabled components. </TD>
</TR>
<TR>
<TD class="confluenceTd"> <TT>scr disable &lt;componentId&gt;</TT> </TD>
<TD class="confluenceTd"> Disable the given component if not already disabled. If the component is already destroyed or disabled, this command has no effect. <TT>&lt;componentId&gt;</TT> may be either the ID of a component or the component's name. The component name must be used for disabled components. </TD>
</TR>
</TBODY></TABLE>
</DIV>


<P>The administrative API commands are also available in the Gogo shell where the subcommand names must be prefixed with the name space <TT>scr</TT>. Thus the <TT>list</TT> command corresponds to <TT>scr:list</TT> in the Gogo shell.</P>


<H3><A name="ApacheFelixServiceComponentRuntime-APIUse"></A>API Use</H3>

<P>The API consists of the main interface <TT>org.apache.felix.scr.ScrService</TT> and two helper interfaces <TT>org.apache.felix.scr.Component</TT> describing a registered component and <TT>org.apache.felix.scr.Reference</TT> describing a single reference of a registered component. To access the management API, client applications just ask for the <TT>ScrService</TT> as usual:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
....
ServiceReference scrServiceRef = bundleContext.getServiceReference( ScrService.class.getName() );
ScrService scrService = (ScrService) bundleContext.getService(scrServiceRef);
....
</PRE>
</DIV></DIV>

<P>Alternatively, you may of course use the <TT>ServiceTracker</TT> or if you are using the <TT>ScrService</TT> in a component, you may have the <TT>ScrService</TT> bound according to the component declaration.</P>

<P>The <TT>ScrService</TT> allows access to all registered components, to a specific component by component ID or to all registered components of a specific bundle.</P>


<H2><A name="ApacheFelixServiceComponentRuntime-Summary"></A>Summary</H2>

<P>This tutorial just listed some very basic information on Declarative Service. To get more information, for example on hoe the Configuration Admin Service may be used to configure components, refer to the Declarative Services Sepecification in the OSGi Service Platform <EM>Service Compendium</EM> book.</P>

<P>Have Fun !</P>
        <DIV class="timestamp" style="margin-top: 30px; font-size: 80%; text-align: right;">
Last modified by fmeschbe on Mon Oct 17 06:03:20 EDT 2011
        </DIV>
        <DIV class="trademarkFooter">
Apache Felix, Felix, Apache, the Apache feather logo, and the Apache Felix project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
        </DIV>
    </DIV>
  </BODY>
</HTML>
