
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML>
  <HEAD>
    <TITLE>Apache Felix - iPOJO Hello Word (Maven-Based) tutorial</TITLE>
    <LINK rel="stylesheet" href="http://felix.apache.org/site/media.data/site.css" type="text/css" media="all">
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </HEAD>
  <BODY>
    <DIV class="title"><DIV class="logo"><A href="http://felix.apache.org/site/index.html"><IMG border="0" alt="Apache Felix" src="http://felix.apache.org/site/media.data/logo.png"></A></DIV><DIV class="header"><A href="http://www.apache.org/"><IMG border="0" alt="Apache" src="http://felix.apache.org/site/media.data/apache.png"></A></DIV></DIV>
    <DIV class="menu">
<UL>
	<LI><A href="news.html" title="news">news</A></LI>
	<LI><A href="http://www.apache.org/licenses/" class="external-link" rel="nofollow">license</A></LI>
	<LI><A href="http://felix.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">downloads</A></LI>
	<LI><A href="documentation.html" title="documentation">documentation</A></LI>
	<LI><A href="mailinglists.html" title="mailinglists">mailing lists</A></LI>
	<LI><A href="contributing.html" title="Contributing">contributing</A></LI>
	<LI><A href="http://www.apache.org/" class="external-link" rel="nofollow">asf</A></LI>
	<LI><A href="http://www.apache.org/security/" class="external-link" rel="nofollow">security</A></LI>
	<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">sponsorship</A></LI>
	<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link" rel="nofollow">sponsors</A>
<!-- ApacheCon Ad -->
<IFRAME src="http://www.apache.org/ads/button.html" style="border-width:0; float: left" frameborder="0" scrolling="no" width="135" height="135"></IFRAME>
<P style="height: 100px">
<!-- ApacheCon Ad --></LI>
</UL>
    </DIV>
    <DIV class="main">
<STYLE type="text/css">
 @import url(http://felix.apache.org/ipojo/site/superfish.css); 
</STYLE>

<STYLE type="text/css">
 @import url(http://felix.apache.org/ipojo/site/style.css); 
</STYLE>

<P>
<SCRIPT class="javascript" src="http://cwiki.apache.org/confluence/download/resources/confluence.ext.code:code/shCore.js"></SCRIPT>
<SCRIPT class="javascript" src="http://cwiki.apache.org/confluence/download/resources/confluence.ext.code:code/shBrushCSharp.js"></SCRIPT>
<SCRIPT class="javascript" src="http://cwiki.apache.org/confluence/download/resources/confluence.ext.code:code/shBrushPhp.js"></SCRIPT>
<SCRIPT class="javascript" src="http://cwiki.apache.org/confluence/download/resources/confluence.ext.code:code/shBrushJScript.js"></SCRIPT>
<SCRIPT class="javascript" src="http://cwiki.apache.org/confluence/download/resources/confluence.ext.code:code/shBrushVb.js"></SCRIPT>
<SCRIPT class="javascript" src="http://cwiki.apache.org/confluence/download/resources/confluence.ext.code:code/shBrushSql.js"></SCRIPT>
<SCRIPT class="javascript" src="http://cwiki.apache.org/confluence/download/resources/confluence.ext.code:code/shBrushXml.js"></SCRIPT>
<SCRIPT class="javascript" src="http://cwiki.apache.org/confluence/download/resources/confluence.ext.code:code/shBrushShell.js"></SCRIPT>
<SCRIPT class="javascript" src="http://cwiki.apache.org/confluence/download/resources/confluence.ext.code:code/shBrushDelphi.js"></SCRIPT>
<SCRIPT class="javascript" src="http://cwiki.apache.org/confluence/download/resources/confluence.ext.code:code/shBrushPython.js"></SCRIPT>
<SCRIPT class="javascript" src="http://cwiki.apache.org/confluence/download/resources/confluence.ext.code:code/shBrushJava.js"></SCRIPT>

<SCRIPT type="text/javascript" src="http://felix.apache.org/ipojo/site/jquery-1.js"></SCRIPT>
<SCRIPT type="text/javascript" src="http://felix.apache.org/ipojo/site/hoverIntent.js"></SCRIPT>
<SCRIPT type="text/javascript" src="http://felix.apache.org/ipojo/site/superfish.js"></SCRIPT> 
<SCRIPT type="text/javascript" src="http://felix.apache.org/ipojo/site/supersubs.js"></SCRIPT> 

<SCRIPT type="text/javascript"> 
 
    $(document).ready(function(){ 
        $("ul.sf-menu").supersubs({ 
            minWidth:    14,   // minimum width of sub-menus in em units 
            maxWidth:    30,   // maximum width of sub-menus in em units 
            extraWidth:  1     // extra width can ensure lines don't sometimes turn over 
                               // due to slight rounding differences and font-family 
        }).superfish();  // call supersubs first, then superfish, so that subs are 
                         // not display:none when measuring. Call before initialising 
                         // containing tabs for same reason. 
    }); 
 
</SCRIPT>
<DIV class="main">
<DIV class="page-header">
<IMG src="http://felix.apache.org/ipojo/site/header.png" class="header">
<A href="http://ipojo.org/"><IMG src="http://felix.apache.org/ipojo/site/ipojo.png" width="225" class="header-logo"></A>
<UL class="sf-menu sf-js-enabled sf-shadow" id="ipojo-menu">
<LI class="current">
<!-- Menu Overview -->
<A href="" class="sf-with-ul">Overview<SPAN class="sf-sub-indicator"> &raquo;</SPAN><SPAN class="sf-sub-indicator"> &raquo;</SPAN></A>
<UL>
	<LI>
	<A href="apache-felix-ipojo.html" title="Apache Felix iPOJO">Home</A>							
	</LI>
	<LI>
	<A href="apache-felix-ipojo-why-choose-ipojo.html" title="apache-felix-ipojo-why-choose-ipojo">Why choose iPOJO</A>
	</LI>
	<LI>
	<A href="apache-felix-ipojo-successstories.html" title="apache-felix-ipojo-successstories">Success stories</A>
	</LI>
	<LI>
	<A href="apache-felix-ipojo-feature-overview.html" title="Apache Felix iPOJO Feature Overview">Features</A>
	</LI>
</UL>
</LI>	

<LI class="">			
<!-- Menu download -->
<LI>
<A href="download.html" title="Download">Download </A>
</LI>

<LI class="">					
<!-- Menu Documentation -->
<A href="" class="sf-with-ul">Documentation<SPAN class="sf-sub-indicator"> &raquo;</SPAN><SPAN class="sf-sub-indicator"> &raquo;</SPAN></A>
<UL>
    <!-- sub- menu : getting started -->
    <LI class="">
    <A href="" class="sf-with-ul">Getting Started<SPAN class="sf-sub-indicator"> &raquo;</SPAN><SPAN class="sf-sub-indicator"> &raquo;</SPAN></A>
    <UL>
     <LI><A href="ipojo-in-10-minutes.html" title="iPOJO in 10 minutes">iPOJO in 10 minutes</A></LI>
     <LI><A href="how-to-use-ipojo-annotations.html" title="How to use iPOJO Annotations">Using Annotations</A></LI>
     <LI><A href="" title="iPOJO Hello Word (Maven-Based) tutorial">Maven tutorial</A></LI>
     <LI><A href="ipojo-advanced-tutorial.html" title="iPOJO Advanced Tutorial">Advanced tutorial</A></LI>
     <LI><A href="apache-felix-ipojo-dosgi.html" title="apache-felix-ipojo-dosgi">Using Distributed OSGi</A></LI>
     <LI><A href="ipojo-composition-tutorial.html" title="iPOJO Composition Tutorial">Application Composition</A></LI>
    </UL>
    </LI> <!-- end of getting started -->
    <!-- sub menu : Describing Components -->
     <LI class="">
        <A href="http://felix.apache.org/site/describing-components.html" class="sf-with-ul">Describing components<SPAN class="sf-sub-indicator"> &raquo;</SPAN><SPAN class="sf-sub-indicator"> &raquo;</SPAN></A>
        <UL>
        <LI><A href="service-requirement-handler.html" title="Service Requirement Handler">Requiring a service</A></LI>
        <LI><A href="providing-osgi-services.html" title="Providing OSGi services">Providing a service</A></LI>
        <LI><A href="lifecycle-callback-handler.html" title="Lifecycle Callback Handler">Lifecycle management</A></LI>
        <LI><A href="configuration-handler.html" title="Configuration Handler">Configuration</A></LI>
        <LI><A href="architecture-handler.html" title="Architecture Handler">Introspection</A></LI>
        <LI><A href="controller-lifecycle-handler.html" title="Controller Lifecycle Handler">Impacting the lifecycle</A></LI>
        <LI><A href="event-admin-handlers.html" title="Event Admin Handlers">Asynchronous communication</A></LI>
        <LI><A href="ipojo-jmx-handler.html" title="iPOJO JMX Handler">JMX management</A></LI>
        <LI><A href="extender-pattern-handler.html" title="Extender Pattern Handler">Extender pattern</A></LI>
        <LI><A href="white-board-pattern-handler.html" title="White Board Pattern Handler">Whiteboard pattern</A></LI>
        <LI><A href="temporal-service-dependency.html" title="Temporal Service Dependency">Temporal dependencies</A></LI>
        </UL>
     </LI> <!-- End of describing components -->
    <!-- sub- menu : User Guide -->
    <LI class="">
    <A href="" class="sf-with-ul">User Guide<SPAN class="sf-sub-indicator"> &raquo;</SPAN><SPAN class="sf-sub-indicator"> &raquo;</SPAN></A>
        <UL>
        <LI><A href="combining-ipojo-and-configuration-admin.html" title="Combining iPOJO and Configuration Admin">iPOJO and config admin</A></LI>
        <LI><A href="how-to-use-ipojo-factories.html" title="How-to use iPOJO factories">Factories and Instances</A></LI>
        <LI><A href="using-xml-schemas.html" title="Using XML Schemas">XML Schemas</A></LI>
        <LI><A href="apache-felix-ipojo-api.html" title="apache-felix-ipojo-api">API</A></LI>
        <LI><A href="apache-felix-ipojo-testing-components.html" title="apache-felix-ipojo-testing-components">Testing components</A></LI>
        <LI><A href="apache-felix-ipojo-eclipse-integration.html" title="apache-felix-ipojo-eclipse-integration">Eclipse Integration</A></LI>
        <LI><A href="ipojo-faq.html" title="iPOJO FAQ">FAQ</A></LI>
        <LI><A href="ipojo-reference-card.html" title="iPOJO-Reference-Card">Reference Card</A></LI>
        </UL>
    </LI> <!-- end of user guide -->
    <!-- sub- menu : Dev Guide -->
    <LI> 
    <A href="" class="sf-with-ul">Advanced Topics<SPAN class="sf-sub-indicator"> &raquo;</SPAN><SPAN class="sf-sub-indicator"> &raquo;</SPAN></A>
       <UL>
        <LI><A href="http://felix.apache.org/ipojo/api/1.6.0" class="external-link" rel="nofollow">Javadoc</A></LI>
        <LI><A href="how-to-write-your-own-handler.html" title="How to write your own handler">Handler development</A></LI>
        <LI><A href="how-to-use-ipojo-manipulation-metadata.html" title="How to use iPOJO Manipulation Metadata">Manipulation Metadata </A></LI>
        <LI><A href="dive-into-the-ipojo-manipulation-depths.html" title="Dive into the iPOJO Manipulation depths">Dive into the iPOJO Manipulation depths</A></LI>
       </UL>
    </LI> <!-- End of Dev guide -->
</UL> 
</LI> <!-- End of doc -->
<!-- Menu 4 : Tools -->
<LI class="">
<A href="" class="sf-with-ul">Tools<SPAN class="sf-sub-indicator"> &raquo;</SPAN><SPAN class="sf-sub-indicator"> &raquo;</SPAN></A>
<UL>
   <LI><A href="ipojo-ant-task.html" title="iPOJO Ant Task">Ant Task</A></LI>
   <LI><A href="ipojo-eclipse-plug-in.html" title="iPOJO Eclipse Plug-in">Eclipse Plugin</A></LI>
   <LI><A href="ipojo-maven-plug-in.html" title="iPOJO Maven Plug-in">Maven Plugin</A></LI>
   <LI><A href="ipojo-arch-command.html" title="iPOJO-Arch-Command"><TT>arch</TT> shell command</A></LI>
   <LI><A href="apache-felix-ipojo-online-manipulator.html" title="apache-felix-ipojo-online-manipulator">Online Manipulator</A></LI>
   <LI><A href="ipojo-webconsole-plugin.html" title="iPOJO Webconsole Plugin">Webconsole plugin</A></LI>
   <LI><A href="apache-felix-ipojo-junit4osgi.html" title="apache-felix-ipojo-junit4osgi">Junit4OSGi</A></LI>
</UL>   
</LI><!-- End of tools -->	
<!-- Menu 5 : Support -->
<LI>
<A href="ipojo-support.html" title="ipojo-support">Support </A>
</LI>
<!-- End of the menu 5 -->			
<!-- Menu 6 : Misc -->
<LI class="">
<A href="" class="sf-with-ul">Misc<SPAN class="sf-sub-indicator"> &raquo;</SPAN><SPAN class="sf-sub-indicator"> &raquo;</SPAN></A>
<UL>
   <LI><A href="apache-felix-ipojo-supportedvms.html" title="apache-felix-ipojo-supportedVMs">Supported JVMs</A></LI>
   <LI><A href="apache-felix-ipojo-supportedosgi.html" title="apache-felix-ipojo-supportedOSGi">Supported OSGi Implementations</A></LI>
   <LI><A href="http://ipojo-dark-side.blogspot.com/" class="external-link" rel="nofollow">iPOJO's Dark Side Blog</A></LI>
   <LI><A href="article-presentations.html" title="Article & Presentations">Article &amp; Presentations</A></LI>
   <LI><A href="http://www.apache.org/">ASF</A></LI>
   <LI><A href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</A></LI>
   <LI><A href="http://www.apache.org/foundation/thanks.html">Sponsors</A></LI>
</UL>
</LI><!-- End of misc -->
</UL> <!-- End of the menu -->
</DIV> <!-- Page header -->
</P>

<DIV class="content">

<H1><A name="iPOJOHelloWord%28Maven-Based%29tutorial-iPOJOHelloWorld"></A>iPOJO Hello World</H1>

<P><EM>This page presents how to use the iPOJO runtime and its associated service component model. The concepts of the service component model are introduced, followed by a simple example that demonstrates the features of iPOJO.</EM></P>

<H2><A name="iPOJOHelloWord%28Maven-Based%29tutorial-Introduction"></A>Introduction</H2>

<P>iPOJO aims to simplify service-oriented programming on OSGi frameworks; the name iPOJO is an abbreviation for <EM>injected POJO</EM>. iPOJO provides a new way to develop OSGi service components with the main goal being to simplify service component implementation by transparently managing the dynamics of the environment as well as other non-functional requirements. The iPOJO framework allows developers to more clearly separate functional code (i.e., the POJO) from the non-functional code (i.e., dependency management, service provision, configuration, etc.). iPOJO combines the functional and non-functional aspects at run time. To achieve this, iPOJO provides a simple and extensible service component model based on POJOs.</P>

<H2><A name="iPOJOHelloWord%28Maven-Based%29tutorial-ThePOJOconcept"></A>The POJO concept</H2>

<P>POJO is an acronym for Plain Old Java Object, but it embodies a concept that the simpler and less intrusive the design of a given framework, the better. The name is used to emphasize that a given object is not somehow special, but is an ordinary Java Object. Martin Fowler, Rebecca Parsons and Josh Mackenzie coined the term POJO in September 2000: &quot;We wondered why people were so against using regular objects in their systems and concluded that it was because simple objects lacked a fancy name. So we gave them one, and it's caught on very nicely.&quot; From the developer's perspective, the iPOJO framework strives to only require POJOs in as much as it is possible.</P>

<H2><A name="iPOJOHelloWord%28Maven-Based%29tutorial-iPOJOservicecomponentoverview"></A>iPOJO service component overview</H2>

<P>A service component is able to provide and/or require services, where a service is an object that implements a given service interface embodied as a Java interface. In addition, iPOJO introduces a callback concept to notify a component about various state changes.</P>

<P>The component is the central concept in iPOJO. In the core iPOJO model, a component describes service dependencies, provided services, and callbacks; this information is recorded in the component's metadata. Then, the second important concept in iPOJO is component instances. A component instances is a special <EM>version</EM> of the component. By merging component metadata and instance configuration, the iPOJO runtime is able to manage the component, i.e., manage its life cycle, inject required services, publish provided services, discover needed services.</P>

<H2><A name="iPOJOHelloWord%28Maven-Based%29tutorial-Asimpleexample"></A>A simple example</H2>

<P>The following is a simple example illustrating how to use the core iPOJO concepts. The example is comprised of two components, one providing a <EM>Hello</EM> service and one requiring any number of <EM>Hello</EM> services. The components are packaged into three different bundles using Maven. The <EM>hello.service</EM> bundle contains the service interface. The <EM>hello.impl</EM> bundle contains a component implementing the service. The <EM>hello.client</EM> bundle contains the consumer component.</P>

<P>Download the tutorial archive <A href="http://people.apache.org/~clement/ipojo/tutorials/maven/tutorial.zip" class="external-link" rel="nofollow">here</A>. This archive contains a version of Felix (configured with iPOJO), and the projects explained below.</P>

<H3><A name="iPOJOHelloWord%28Maven-Based%29tutorial-PreparingMaven%26Installingthetutorial"></A>Preparing Maven &amp; Installing the tutorial</H3>

<P>The first step is to download and install Maven; the example was created using Maven 2.1+. Once maven is installed on your machine, you can compile the tutorial by unzipping the archive, and by launching the '<EM>mvn clean install</EM>' command at the root of tutorial.</P>

<P><EM>Be aware that Maven outputs a lot of information while it executes and often downloads a lot of required JAR files into its local repository.</EM></P>

<H3><A name="iPOJOHelloWord%28Maven-Based%29tutorial-HelloService"></A>Hello Service</H3>

<P>The first project is the <EM>hello.service</EM> project. This project contains only the <EM>hello</EM> service interface. Look at the <TT>src/main/java/ipojo/example/hello/Hello.java</TT> file.</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
/**
 * Hello Interface.
 * @author &lt;a href=<SPAN class="code-quote">&quot;mailto:dev@felix.apache.org&quot;</SPAN>&gt;Felix Project Team&lt;/a&gt;
 */
<SPAN class="code-keyword">public</SPAN> <SPAN class="code-keyword">interface</SPAN> Hello {

    /**
     * Returns a message like: <SPAN class="code-quote">&quot;Hello $user_name&quot;</SPAN>.
     * @param name the name
     * @<SPAN class="code-keyword">return</SPAN> the hello message
     */
    <SPAN class="code-object">String</SPAN> sayHello(<SPAN class="code-object">String</SPAN> name);
}
</PRE>
</DIV></DIV>

<P>In the project directory, the pom.xml file contains the instructions to build the bundle. The bundle uses the <EM>maven-bundle-plugin</EM> (see here for more information on this plug-in).</P>
<DIV class="pom"><P>&lt;project&gt;<BR>
&nbsp;&nbsp;&nbsp; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<BR>
&nbsp;&nbsp;&nbsp; &lt;packaging&gt;bundle&lt;/packaging&gt;<BR>
&nbsp;&nbsp;&nbsp; <FONT color="#ff0000">&lt;groupId&gt;ipojo.example&lt;/groupId&gt;</FONT><BR>
<FONT color="#ff0000">&nbsp;&nbsp;&nbsp; &lt;artifactId&gt;hello.service&lt;/artifactId&gt;</FONT><BR>
<FONT color="#ff0000">&nbsp;&nbsp;&nbsp; &lt;version&gt;1.0.0&lt;/version&gt;</FONT><BR>
<FONT color="#ff0000">&nbsp;&nbsp;&nbsp; &lt;name&gt;Hello Service&lt;/name&gt;</FONT></P>

<P>&lt;build&gt;<BR>
&nbsp;&nbsp;&nbsp; &lt;plugins&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;plugin&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;artifactId&gt;maven-bundle-plugin&lt;/artifactId&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;version&gt;2.0.1&lt;/version&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;extensions&gt;true&lt;/extensions&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;configuration&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;instructions&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;Bundle-SymbolicName&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ${pom.artifactId}<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/Bundle-SymbolicName&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <FONT color="#ff0000">&lt;Export-Package&gt;</FONT><BR>
<FONT color="#ff0000">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ipojo.example.hello</FONT><BR>
<FONT color="#ff0000">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/Export-Package&gt;</FONT><BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/instructions&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/configuration&gt;<BR>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/plugin&gt;<BR>
&nbsp;&nbsp;&nbsp; &lt;/plugins&gt;<BR>
&lt;/build&gt;</P>

<P>&lt;/project&gt;</P></DIV>
<P>Then, the project is ready to be built issuing the following Maven command inside the project directory:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
mvn clean install
</PRE>
</DIV></DIV>
<P>Maven should report that the build was a success; if an error was reported then verify the previous steps. Upon success the <EM>Hello</EM> service component JAR file is installed into the local Maven repository. A copy of the bundle JAR file will also be present in the &quot;target&quot; directory inside the project directory.</P>

<H3><A name="iPOJOHelloWord%28Maven-Based%29tutorial-HelloServiceProvider"></A>Hello Service Provider</H3>

<P>The component implementation of the service is a simple Java class implementing the <EM>Hello</EM> service interface. The implementation is in the <EM>hello.impl</EM> project. The file <TT>src/main/java/ipojo/example/hello/impl/HelloImpl.java</TT> contains the following service implementation:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
/**
 * Component implementing the Hello service.
 * @author &lt;a href=<SPAN class="code-quote">&quot;mailto:dev@felix.apache.org&quot;</SPAN>&gt;Felix Project Team&lt;/a&gt;
 */
<SPAN class="code-keyword">public</SPAN> class HelloImpl <SPAN class="code-keyword">implements</SPAN> Hello {

    /**
     * Returns an 'Hello' message.
     * @param name : name
     * @<SPAN class="code-keyword">return</SPAN> Hello message
     * @see ipojo.example.hello.Hello#sayHello(java.lang.<SPAN class="code-object">String</SPAN>)
     */
    <SPAN class="code-keyword">public</SPAN> <SPAN class="code-object">String</SPAN> sayHello(<SPAN class="code-object">String</SPAN> name) { <SPAN class="code-keyword">return</SPAN> <SPAN class="code-quote">&quot;hello &quot;</SPAN> + name;  }
}
</PRE>
</DIV></DIV>
<P>To manage the component, iPOJO needs some metadata to understand that the component provides the <EM>Hello</EM> service. iPOJO metadata file is at the root of the <EM>hello.impl</EM> project (&quot;metadata.xml&quot;). It contains the following metadata (Note: iPOJO also supports a JAR manifest-based syntax):</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
<SPAN class="code-tag">&lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN> encoding=<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>?&gt;</SPAN>
&lt;ipojo 
    <SPAN class="code-keyword">xmlns:xsi</SPAN>=<SPAN class="code-quote">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</SPAN>
    xsi:schemaLocation=<SPAN class="code-quote">&quot;org.apache.felix.ipojo http://felix.apache.org/ipojo/schemas/CURRENT/core.xsd&quot;</SPAN> 
    xmlns=<SPAN class="code-quote">&quot;org.apache.felix.ipojo&quot;</SPAN>&gt;
      
  &lt;component classname=<SPAN class="code-quote">&quot;ipojo.example.hello.impl.HelloImpl&quot;</SPAN>
    name=<SPAN class="code-quote">&quot;HelloProvider&quot;</SPAN>&gt;
    <SPAN class="code-tag">&lt;provides /&gt;</SPAN>
  <SPAN class="code-tag">&lt;/component&gt;</SPAN>
  
  <SPAN class="code-tag">&lt;instance component=<SPAN class="code-quote">&quot;HelloProvider&quot;</SPAN> name=<SPAN class="code-quote">&quot;HelloService&quot;</SPAN> /&gt;</SPAN>
<SPAN class="code-tag">&lt;/ipojo&gt;</SPAN>
</PRE>
</DIV></DIV>
<P>In the above XML-based metadata, the <EM>component</EM> element has a mandatory '<EM>classname'_attribute. This attribute tells iPOJO the implementation class of the component. Since the component in this example provides a service, the component element also specifies a child '_provides</EM>' element. The '<EM>provides</EM>' element informs iPOJO that it must manage the publishing of a service. When the '<EM>provides</EM>' element does not contain an interface attribute, as is the case in this example, iPOJO will expose all implemented interfaces of the component as a service; it is also possible to specify the precise service interface. The '<EM>instance</EM>' element asks iPOJO to create an instance of your component when the bundle is started.</P>

<P>Finally, the &quot;pom.xml&quot; file contains instructions to build the bundle:</P>
<DIV class="pom"><P>&lt;project&gt;<BR>
&nbsp;&nbsp;&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<BR>
&nbsp; &lt;packaging&gt;bundle&lt;/packaging&gt;<BR>
&nbsp;&nbsp;<FONT color="red">&lt;groupId&gt;ipojo.example&lt;/groupId&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&lt;artifactId&gt;hello.impl&lt;/artifactId&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&lt;version&gt;1.0.0&lt;/version&gt;</FONT></P>

<P>&nbsp;&nbsp;<FONT color="red">&lt;name&gt;Hello Service Provider&lt;/name&gt;</FONT></P>

<P><FONT color="red">&nbsp; &lt;dependencies&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp; &nbsp;&lt;dependency&gt; &lt;!--Compilation (i.e. class) dependency on the service interface --&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&lt;groupId&gt;ipojo.example&lt;/groupId&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&lt;artifactId&gt;hello.service&lt;/artifactId&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&lt;version&gt;</FONT><FONT color="#ff0000">1.0.0</FONT><FONT color="red">&lt;/version&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp; &nbsp;&lt;/dependency&gt;</FONT><BR>
<FONT color="red">&nbsp; &lt;/dependencies&gt;</FONT></P>


<P>&nbsp;&nbsp;&lt;build&gt;<BR>
&nbsp;&nbsp; &lt;plugins&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;plugin&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;artifactId&gt;maven-bundle-plugin&lt;/artifactId&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;version&gt;2.0.1&lt;/version&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;extensions&gt;true&lt;/extensions&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;configuration&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;instructions&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Bundle-SymbolicName&gt;${pom.artifactId}&lt;/Bundle-SymbolicName&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="red">&lt;Private-Package&gt;ipojo.example.hello.impl&lt;/Private-Package&gt;</FONT><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/instructions&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/configuration&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;/plugin&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;plugin&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;artifactId&gt;maven-ipojo-plugin&lt;/artifactId&gt;<BR>
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;version&gt;1.6.0&lt;/version&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;executions&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;execution&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;goals&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;goal&gt;ipojo-bundle&lt;/goal&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/goals&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;/execution&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/executions&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;/plugin&gt;<BR>
&nbsp;&nbsp; &lt;/plugins&gt;<BR>
&nbsp;&lt;/build&gt;<BR>
&lt;/project&gt;</P></DIV>
<P>The text highlighted in <FONT color="red"><B>red</B></FONT> above indicates the important information related to the project. The first part of the POM file indicates that the packaging format is an iPOJO bundle and also includes some information about the project (name, groupId, and artifactId). This information is not used by iPOJO, but is used by Maven. The rest of the POM file contains the bundle configuration. In the <EM>instructions</EM> element, you need to enter the bundle name, the bundle description, and the exported packages. The service provider bundle exports the package of <EM>Hello</EM> interface.</P>

<P>Then, the project is ready to be built issuing the following Maven command inside the project directory:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
mvn clean install
</PRE>
</DIV></DIV>
<P>Maven should report that the build was a success; if an error was reported then verify the previous steps. Upon success the <EM>Hello</EM> service component JAR file is installed into the local Maven repository. A copy of the bundle JAR file will also be present in the &quot;target&quot; directory inside the project directory.</P>

<H3><A name="iPOJOHelloWord%28Maven-Based%29tutorial-HelloServiceClient"></A>Hello Service Client</H3>

<P>The Hello service consumer is inside the <EM>hello.client</EM> project. The file <TT>src/main/java/ipojo/example/hello/client/HelloClient.java</TT> contains the following <EM>Hello</EM> service client:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
<SPAN class="code-keyword">package</SPAN> ipojo.example.hello.client;

<SPAN class="code-keyword">import</SPAN> ipojo.example.hello.Hello;

/**
 * Hello Service simple client.
 * @author &lt;a href=<SPAN class="code-quote">&quot;mailto:dev@felix.apache.org&quot;</SPAN>&gt;Felix Project Team&lt;/a&gt;
 */
<SPAN class="code-keyword">public</SPAN> class HelloClient <SPAN class="code-keyword">implements</SPAN> <SPAN class="code-object">Runnable</SPAN> {

    /**
     *  Delay between two invocations.
     */
    <SPAN class="code-keyword">private</SPAN> <SPAN class="code-keyword">static</SPAN> <SPAN class="code-keyword">final</SPAN> <SPAN class="code-object">int</SPAN> DELAY = 10000;

    /**
     * Hello services.
     * Injected by the container.
     * */
    <SPAN class="code-keyword">private</SPAN> Hello[] m_hello;

    /**
     * End flag.
     *  */
    <SPAN class="code-keyword">private</SPAN> <SPAN class="code-object">boolean</SPAN> m_end;

    /**
     * Run method.
     * @see java.lang.<SPAN class="code-object">Runnable</SPAN>#run()
     */
    <SPAN class="code-keyword">public</SPAN> void run() {
        <SPAN class="code-keyword">while</SPAN> (!m_end) {
            <SPAN class="code-keyword">try</SPAN> {
                invokeHelloServices();
                <SPAN class="code-object">Thread</SPAN>.sleep(DELAY);
            } <SPAN class="code-keyword">catch</SPAN> (InterruptedException ie) {
                /* will recheck end */
            }
        }
    }

    /**
     * Invoke hello services.
     */
    <SPAN class="code-keyword">public</SPAN> void invokeHelloServices() {
        <SPAN class="code-keyword">for</SPAN> (<SPAN class="code-object">int</SPAN> i = 0; i &lt; m_hello.length; i++) {
            <SPAN class="code-comment">// Update with your name.
</SPAN>            <SPAN class="code-object">System</SPAN>.out.println(m_hello[i].sayHello(<SPAN class="code-quote">&quot;world&quot;</SPAN>));
        }
    }

    /**
     * Starting.
     */
    <SPAN class="code-keyword">public</SPAN> void starting() {
        <SPAN class="code-object">Thread</SPAN> thread = <SPAN class="code-keyword">new</SPAN> <SPAN class="code-object">Thread</SPAN>(<SPAN class="code-keyword">this</SPAN>);
        m_end = <SPAN class="code-keyword">false</SPAN>;
        thread.start();
    }

    /**
     * Stopping.
     */
    <SPAN class="code-keyword">public</SPAN> void stopping() {
        m_end = <SPAN class="code-keyword">true</SPAN>;
    }
}
</PRE>
</DIV></DIV>
<P>The <EM>Hello</EM> service client creates a thread that periodically invokes the available <EM>Hello</EM> services. The thread starts when at least one <EM>Hello</EM> service provider is present using iPOJO's call back mechanism. In the client code, to use the <EM>hello</EM> the component implementation simply declares a field of the type of the service and then simply uses it directly in its code. In this example, it is the m_hello field is declared as the service field; notice that the field is an array of <EM>Hello</EM>. In iPOJO an array of services represents an aggregate or multiple cardinality dependency, whereas if a scalar value represents a singular or unary cardinality dependency. In other words, for a singular dependency simply remove the array brackets from the example (e.g., HelloService m_hello[]. After declaring a field for the service, the rest of the component code can simply assume that the service field will be initialized, e.g., m_hello[i].sayHello(&quot;world&quot;).</P>

<P>Notice that iPOJO manages service synchronization too. So, the service invocations do not require synchronization blocks. This synchronization is maintained on a per thread basis, where each method that accesses a service is instrumented to attach the given service instance to the thread so that the thread will continue to see the same service instances even across nested method invocations. The thread will not see different service instances until it completely exits from the first method it entered which used a services. Thus, you would not want to access services in the <TT>run()</TT> method above, because the thread would always see the same service instance.</P>

<P>The component provides two callback methods for its activation and deactivation, starting() and stopping(), respectively. Callbacks are used when the component needs to be informed about a component state change. In iPOJO, the component state is either <B>INVALID</B> (i.e., not all of the component's constraints are satisfied) or <B>VALID</B> (i.e., all of the component's constraints are satisfied). In this example, the starting callback method creates and starts a thread; the stopping callback method stops the thread. The component metadata will instruct iPOJO to invoke these methods when the component's state changes to <B>VALID</B> or <B>INVALID</B> respectively.</P>

<P>The iPOJO metadata file describing the component is &quot;metadata.xml&quot; and contains the following metadata:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
<SPAN class="code-tag">&lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN> encoding=<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>?&gt;</SPAN>
&lt;ipojo 
    <SPAN class="code-keyword">xmlns:xsi</SPAN>=<SPAN class="code-quote">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</SPAN>
    xsi:schemaLocation=<SPAN class="code-quote">&quot;org.apache.felix.ipojo http://felix.apache.org/ipojo/schemas/CURRENT/core.xsd&quot;</SPAN> 
    xmlns=<SPAN class="code-quote">&quot;org.apache.felix.ipojo&quot;</SPAN>&gt;

  <SPAN class="code-tag">&lt;component classname=<SPAN class="code-quote">&quot;ipojo.example.hello.client.HelloClient&quot;</SPAN>&gt;</SPAN>
    <SPAN class="code-tag">&lt;requires field=<SPAN class="code-quote">&quot;m_hello&quot;</SPAN> /&gt;</SPAN>
    <SPAN class="code-tag">&lt;callback transition=<SPAN class="code-quote">&quot;validate&quot;</SPAN> method=<SPAN class="code-quote">&quot;starting&quot;</SPAN> /&gt;</SPAN>
    <SPAN class="code-tag">&lt;callback transition=<SPAN class="code-quote">&quot;invalidate&quot;</SPAN> method=<SPAN class="code-quote">&quot;stopping&quot;</SPAN> /&gt;</SPAN>
    <SPAN class="code-tag">&lt;properties&gt;</SPAN>
      <SPAN class="code-tag">&lt;property field=<SPAN class="code-quote">&quot;m_name&quot;</SPAN> name=<SPAN class="code-quote">&quot;hello.name&quot;</SPAN> /&gt;</SPAN>
    <SPAN class="code-tag">&lt;/properties&gt;</SPAN>
  <SPAN class="code-tag">&lt;/component&gt;</SPAN>

  <SPAN class="code-tag">&lt;instance component=<SPAN class="code-quote">&quot;ipojo.example.hello.client.HelloClient&quot;</SPAN>&gt;</SPAN>
    <SPAN class="code-tag">&lt;property name=<SPAN class="code-quote">&quot;hello.name&quot;</SPAN> value=<SPAN class="code-quote">&quot;clement&quot;</SPAN> /&gt;</SPAN>
  <SPAN class="code-tag">&lt;/instance&gt;</SPAN>
<SPAN class="code-tag">&lt;/ipojo&gt;</SPAN>
</PRE>
</DIV></DIV>
<P>The component element again has the '<EM>classname'</EM> attribute that refers to the component implementation class. The '<EM>requires</EM>' element describes the <EM>Hello</EM> service dependency by simply specifying its associated component field. The '<EM>callback'_elements describe which method to invoke when the component's state changes. Then the '_instance</EM>' element asks iPOJO to create an instance of the component (notice that no instance name is provided here, iPOJO will give an instance name to the instance automatically).</P>

<P>Finally, the &quot;pom.xml&quot; file contains instructions to build the bundle:</P>
<DIV class="pom"><P>&lt;project&gt;<BR>
&nbsp;&nbsp;&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<BR>
&nbsp;&nbsp;&lt;packaging&gt;bundle&lt;/packaging&gt;<BR>
&nbsp;&nbsp;<FONT color="red">&lt;groupId&gt;ipojo.example&lt;/groupId&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&lt;artifactId&gt;hello.client&lt;/artifactId&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&lt;version&gt;1.0.0&lt;/version&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&lt;name&gt;Hello Client&lt;/name&gt;</FONT></P>

<P><FONT color="red">&nbsp;&nbsp;&lt;dependencies&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp; &nbsp;&lt;dependency&gt; &lt;&#33;-&#45;</FONT> <FONT color="red">Compilation (i.e. class) dependency on the service interface &#45;&#45;</FONT><FONT color="red">&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&lt;groupId&gt;ipojo.example&lt;/groupId&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&lt;artifactId&gt;hello.service&lt;/artifactId&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&lt;version&gt;</FONT><FONT color="#ff0000">1.0.0</FONT><FONT color="red">&lt;/version&gt;</FONT><BR>
<FONT color="red">&nbsp;&nbsp; &nbsp;&lt;/dependency&gt;</FONT><BR>
<FONT color="red">&nbsp; &lt;/dependencies&gt;</FONT></P>

<P>&nbsp; &lt;build&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;plugins&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;plugin&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;artifactId&gt;maven-bundle-plugin&lt;/artifactId&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;version&gt;2.0.1&lt;/version&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;extensions&gt;true&lt;/extensions&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;configuration&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;instructions&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Bundle-SymbolicName&gt;${pom.artifactId}&lt;/Bundle-SymbolicName&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="red">&lt;Private-Package&gt;ipojo.example.hello.client&lt;/Private-Package&gt;</FONT><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/instructions&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;/configuration&gt;<BR>
&nbsp;&nbsp; &lt;/plugin&gt;<BR>
&nbsp;&nbsp; &lt;plugin&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;artifactId&gt;maven-ipojo-plugin&lt;/artifactId&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;version&gt;1.6.0&lt;/version&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;executions&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;execution&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;goals&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;goal&gt;ipojo-bundle&lt;/goal&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/goals&gt;<BR>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/execution&gt;<BR>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;/executions&gt;<BR>
&nbsp;&nbsp; &lt;/plugin&gt;<BR>
&nbsp;&lt;/plugins&gt;<BR>
&nbsp; &lt;/build&gt;<BR>
&lt;/project&gt;</P></DIV>
<P>The text highlighted in <FONT color="red"><B>red</B></FONT> above indicates the information related to the project. The <EM>dependencies</EM> element tells Maven that the client bundle has a compilation dependency on the service provider bundle. In this case, the client bundle needs the <EM>Hello</EM> service interface to compile. After building the service provider bundle JAR file, Maven installs it into a local repository on your machine. To resolve compilation dependencies, Maven looks in the local repository to find required JAR files.<BR>
After the skeleton &quot;pom.xml&quot; file is modified, the project is ready to be built issuing the following Maven command inside the project directory:<BR>
mvn clean install<BR>
Maven should report that the build was a success; if an error was reported then verify the previous steps. Upon success the <EM>Hello</EM> service component JAR file is installed into the local Maven repository. A copy of the bundle JAR file will also be present in the &quot;target&quot; directory inside the project directory.</P>

<H2><A name="iPOJOHelloWord%28Maven-Based%29tutorial-Runningtheexample"></A>Running the example</H2>

<P>To run the example, start Felix. A distribution of Felix is provided in the felix-1.0.3 directory. This version is configured to launch iPOJO automatically. From the Felix directory, launch the following command to start the framework</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
java -jar bin/felix.jar
</PRE>
</DIV></DIV>
<P>You can check installed bundles by using the '<EM>ps'</EM> command:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
-&gt; ps
START LEVEL 1
   ID   State         Level  Name
[   0] [Active     ] [    0] <SPAN class="code-object">System</SPAN> Bundle (2.0.5)
[   1] [Active     ] [    1] Apache Felix Bundle Repository (1.4.3)
[   2] [Active     ] [    1] Apache Felix iPOJO (1.6.0)
[   3] [Active     ] [    1] Apache Felix iPOJO Arch Command (1.6.0)
[   4] [Active     ] [    1] Apache Felix Shell Service (1.4.2)
[   5] [Active     ] [    1] Apache Felix Shell TUI (1.4.1)
-&gt;
</PRE>
</DIV></DIV>
<P>iPOJO runtime is the bundle 4. The bundle 5 is a Felix shell command allowing the introspection of iPOJO component instances (see herefor further information).</P>

<P>Install the Hello service bundle, the <EM>Hello</EM> service provider and the client that were created above:</P>
<DIV class="shell"><P>start <A href="file:../hello.service/target/hello.service-1.0.0.jar" class="external-link" rel="nofollow">file:../hello.service/target/hello.service-1.0.0.jar</A><BR>
start <A href="file:../hello.impl/target/hello.impl-1.0.0.jar" class="external-link" rel="nofollow">file:../hello.impl/target/hello.impl-1.0.0.jar</A><BR>
start <A href="file:../hello.client/target/hello.client-1.0.0.jar" class="external-link" rel="nofollow">file:../hello.client/target/hello.client-1.0.0.jar</A></P></DIV>
<P>By starting the <EM>Hello</EM> service provider bundle, the client component will automatically be activated. So, the <EM>'hello world'</EM> messages are displayed.</P>
<DIV class="shell"><P>&#45;&gt; hello world<BR>
hello world</P></DIV>
<P>Stop the provider (with the '<EM>stop 7</EM>' command) and the client will automatically be deactivated since its dependency is no longer valid. If multiple Hello services are deployed, the client will connect to all of them. If you restart the bundle (with the <EM>start 7</EM> command), the client becomes valid.</P>

<P>During these operations, you can use the arch command to check the state of instances.</P>
<DIV class="shell"><P>&#45;&gt; stop 7<BR>
&#45;&gt; arch<BR>
Instance ArchCommand &#45;&gt; valid<BR>
<FONT color="red">Instance ipojo.example.hello.client.HelloClient-0 &#45;&gt; invalid</FONT><BR>
&#45;&gt; arch &#45;instance ipojo.example.hello.client.HelloClient-0<BR>
instance name=&quot;ipojo.example.hello.client.HelloClient-0&quot; <BR>
&nbsp;component.type=&quot;ipojo.example.hello.client.HelloClient&quot; <BR>
&nbsp;state=&quot;<FONT color="red">invalid</FONT>&quot; bundle=&quot;8&quot;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object name=&quot;ipojo.example.hello.client.HelloClient@137c60d&quot;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="red">handler name=&quot;org.apache.felix.ipojo.handlers.dependency.DependencyHandler&quot; state=&quot;invalid&quot;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color="red">requires aggregate=&quot;true&quot; optional=&quot;false&quot; state=&quot;resolved&quot; specification=&quot;ipojo.example.hello.Hello&quot;</FONT><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; handler name=&quot;org.apache.felix.ipojo.handlers.lifecycle.callback.LifecycleCallbackHandler&quot; state=&quot;valid&quot;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; handler name=&quot;org.apache.felix.ipojo.handlers.architecture.ArchitectureHandler&quot; state=&quot;valid&quot;<BR>
&#45;&gt; start 7<BR>
hello world<BR>
&#45;&gt; arch<BR>
Instance ArchCommand &#45;&gt; valid<BR>
<FONT color="red">Instance ipojo.example.hello.client.HelloClient-0 &#45;&gt; valid</FONT><BR>
Instance HelloService &#45;&gt; valid<BR>
&#45;&gt; arch &#45;instance ipojo.example.hello.client.HelloClient-0<BR>
instance name=&quot;ipojo.example.hello.client.HelloClient-0&quot; <BR>
&nbsp;component.type=&quot;ipojo.example.hello.client.HelloClient&quot;<BR>
&nbsp; state=&quot;valid&quot; bundle=&quot;8&quot;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object name=&quot;ipojo.example.hello.client.HelloClient@137c60d&quot;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color="red">handler name=&quot;org.apache.felix.ipojo.handlers.dependency.DependencyHandler&quot; state=&quot;valid&quot;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color="red">requires aggregate=&quot;true&quot; optional=&quot;false&quot; state=&quot;resolved&quot; specification=&quot;ipojo.example.hello.Hello&quot;</FONT><BR>
<FONT color="red">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT> <FONT color="red">uses service.id=&quot;38&quot; instance.name=&quot;HelloService&quot;</FONT><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; handler name=&quot;org.apache.felix.ipojo.handlers.lifecycle.callback.LifecycleCallbackHandler&quot; state=&quot;valid&quot;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; handler name=&quot;org.apache.felix.ipojo.handlers.architecture.ArchitectureHandler&quot; state=&quot;valid&quot;</P></DIV>

<H2><A name="iPOJOHelloWord%28Maven-Based%29tutorial-Conclusion"></A>Conclusion</H2>
<P>We saw how to use easily iPOJO to build service-oriented components. Subscribe to the Felix users mailing list by sending a message to <A href="mailto:users-subscribe@felix.apache.org" class="external-link" rel="nofollow">users-subscribe@felix.apache.org</A>; after subscribing, email questions or feedback to <A href="mailto:users@felix.apache.org" class="external-link" rel="nofollow">users@felix.apache.org</A>.
<BR class="atl-forced-newline">
<BR class="atl-forced-newline"></P>

 </DIV>
        <IMG src="http://felix.apache.org/ipojo/site/footer.png" class="footer">
</DIV>

<SCRIPT type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>
<SCRIPT type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-1518442-4");
pageTracker._trackPageview();
} catch(err) {}
</SCRIPT>

        <DIV class="timestamp" style="margin-top: 30px; font-size: 80%; text-align: right;">
Last modified by clement.escoffier on 2010-04-28 03:24:07.0
        </DIV>
        <DIV class="trademarkFooter">
Apache Felix, Felix, Apache, the Apache feather logo, and the Apache Felix project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
        </DIV>
    </DIV>
  </BODY>
</HTML>
