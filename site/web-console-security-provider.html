
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML>
  <HEAD>
    <TITLE>Apache Felix - Web Console Security Provider</TITLE>
    <LINK rel="stylesheet" href="http://felix.apache.org/site/media.data/site.css" type="text/css" media="all">
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </HEAD>
  <BODY>
    <DIV class="title"><DIV class="logo"><A href="http://felix.apache.org/site/index.html"><IMG border="0" alt="Apache Felix" src="http://felix.apache.org/site/media.data/logo.png"></A></DIV><DIV class="header"><A href="http://www.apache.org/"><IMG border="0" alt="Apache" src="http://felix.apache.org/site/media.data/apache.png"></A></DIV></DIV>
    <DIV class="menu">
<UL>
	<LI><A href="news.html" title="news">news</A></LI>
	<LI><A href="http://www.apache.org/licenses/" class="external-link" rel="nofollow">license</A></LI>
	<LI><A href="http://felix.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">downloads</A></LI>
	<LI><A href="documentation.html" title="documentation">documentation</A></LI>
	<LI><A href="mailinglists.html" title="mailinglists">mailing lists</A></LI>
	<LI><A href="contributing.html" title="Contributing">contributing</A></LI>
	<LI><A href="http://www.apache.org/" class="external-link" rel="nofollow">asf</A></LI>
	<LI><A href="http://www.apache.org/security/" class="external-link" rel="nofollow">security</A></LI>
	<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">sponsorship</A></LI>
	<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link" rel="nofollow">sponsors</A>
<!-- ApacheCon Ad -->
<IFRAME src="http://www.apache.org/ads/button.html" style="border-width:0; float: left" frameborder="0" scrolling="no" width="135" height="135"></IFRAME>
<P style="height: 100px">
<!-- ApacheCon Ad --></LI>
</UL>
    </DIV>
    <DIV class="main">
<H1><A name="WebConsoleSecurityProvider-WebConsoleSecurityProvider"></A>Web Console Security Provider</H1>

<DIV><A href="#WebConsoleSecurityProvider-WebConsoleSecurityProvider">WebConsoleSecurityProvider</A> | <A href="#WebConsoleSecurityProvider-WebConsoleSecurityProvider2">WebConsoleSecurityProvider2</A> | <A href="#WebConsoleSecurityProvider-Sample">Sample</A></DIV>

<P>As of Apache Felix Web Console 3.1.0 security of the Web Console can be extended by providing a <TT>WebConsoleSecurityProvicer</TT> service. An extension to this service has been introduced with the <TT>WebConsoleSecurityProvider2</TT> service in Apache Felix Web Console 3.1.4.</P>

<H2><A name="WebConsoleSecurityProvider-WebConsoleSecurityProvider"></A>WebConsoleSecurityProvider</H2>

<P>The <TT>WebConsoleSecurityProvider</TT> service provides two methods:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
/**
 * Authenticates the user with the given user name and password.
 *
 * @param username The name of the user presented by the client
 * @param password The password presented by the client
 * @<SPAN class="code-keyword">return</SPAN> Some object representing the authenticated user indicating general
 *         access to be granted to the web console. If the user cannot be
 *         authenticated (e.g. unknown user name or wrong password) or the
 *         user must not be allowed access to the web console at all
 *         &lt;code&gt;<SPAN class="code-keyword">null</SPAN>&lt;/code&gt; must be returned from <SPAN class="code-keyword">this</SPAN> method.
 */
<SPAN class="code-keyword">public</SPAN> <SPAN class="code-object">Object</SPAN> authenticate( <SPAN class="code-object">String</SPAN> username, <SPAN class="code-object">String</SPAN> password );


/**
 * Checks whether bthe authenticated user has the given role permission.
 *
 * @param user The object referring to the authenticated user. This is the
 *      object returned from the {@link #authenticate(<SPAN class="code-object">String</SPAN>, <SPAN class="code-object">String</SPAN>)}
 *      method and will never be &lt;code&gt;<SPAN class="code-keyword">null</SPAN>&lt;/code&gt;.
 * @param role The requested role
 * @<SPAN class="code-keyword">return</SPAN> &lt;code&gt;<SPAN class="code-keyword">true</SPAN>&lt;/code&gt; <SPAN class="code-keyword">if</SPAN> the user is given permission <SPAN class="code-keyword">for</SPAN> the given
 *      role.
 */
<SPAN class="code-keyword">public</SPAN> <SPAN class="code-object">boolean</SPAN> authorize( <SPAN class="code-object">Object</SPAN> user, <SPAN class="code-object">String</SPAN> role );
</PRE>
</DIV></DIV>

<DIV class="panelMacro"><TABLE class="noteMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="https://cwiki.apache.org/confluence/images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>Use of the <TT>authorize</TT> method is not currently implemented, though. Mainly this is because it is not readily clear, what exactly the <TT>role</TT> means. One possible interpretation could be that this is the label of the plugin whose access is checked. Or it might be a combination of the plugin called and the request method used.</TD></TR></TABLE></DIV>

<P>The drawback of the <TT>WebConsoleSecurityProvider</TT> interface is that it just provides a mechanism to check for a user name and password using HTTP BASIC authentication. If other authenication mechanisms should be used the <TT>WebConsoleSecurityProvider2</TT> interface introduced in Apache Felix Web Console 3.1.4 can be used.</P>


<H2><A name="WebConsoleSecurityProvider-WebConsoleSecurityProvider2"></A>WebConsoleSecurityProvider2</H2>

<P>The <TT>WebConsoleSecurityProvider2</TT> interface extends the <TT>WebConsoleSecurityProvider</TT> by a single method:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
/**
 * The name of the request attribute providing the object representing the
 * authenticated user. This object is used to call the
 * {@link WebConsoleSecurityProvider#authorize(<SPAN class="code-object">Object</SPAN>, <SPAN class="code-object">String</SPAN>)} to
 * authorize access <SPAN class="code-keyword">for</SPAN> certain roles.
 */
<SPAN class="code-object">String</SPAN> USER_ATTRIBUTE = <SPAN class="code-quote">&quot;org.apache.felix.webconsole.user&quot;</SPAN>;


/**
 * Authenticates the given request or asks the client <SPAN class="code-keyword">for</SPAN> credentials.
 * &lt;p&gt;
 * Implementations of <SPAN class="code-keyword">this</SPAN> method are expected to respect and implement
 * the semantics of the &lt;code&gt;HttpContext.handleSecurity&lt;/code&gt; method
 * as specified in the OSGi HTTP Service specification.
 * &lt;p&gt;
 * If <SPAN class="code-keyword">this</SPAN> method returns &lt;code&gt;<SPAN class="code-keyword">true</SPAN>&lt;/code&gt; it is assumed the request
 * provided valid credentials identifying the user as accepted to access
 * the web console. In addition, the {@link #USER_ATTRIBUTE} request
 * attribute must be set to a non-&lt;code&gt;<SPAN class="code-keyword">null</SPAN>&lt;/code&gt; object reference
 * identifying the authenticated user.
 * &lt;p&gt;
 * If <SPAN class="code-keyword">this</SPAN> method returns &lt;code&gt;<SPAN class="code-keyword">false</SPAN>&lt;/code&gt; the request to the web console
 * is terminated without any more response sent back to the client. That is
 * the implementation is expected to have informed the client in <SPAN class="code-keyword">case</SPAN> of
 * non-granted access.
 *
 * @param request The request object
 * @param response The response object
 * @<SPAN class="code-keyword">return</SPAN> &lt;code&gt;<SPAN class="code-keyword">true</SPAN>&lt;/code&gt; If the request provided valid credentials.
 */
<SPAN class="code-keyword">public</SPAN> <SPAN class="code-object">boolean</SPAN> authenticate( HttpServletRequest request, HttpServletResponse response );
</PRE>
</DIV></DIV>

<P>This method is in full control of authentication and thus has to extract the user credentials from the request and can also fail the request.</P>


<H2><A name="WebConsoleSecurityProvider-Sample"></A>Sample</H2>

<P>A sample of a <TT>WebConsoleSecurityProvider</TT> service is the Apache Sling implementation <A href="http://svn.apache.org/repos/asf/sling/trunk/bundles/extensions/webconsolesecurityprovider/src/main/java/org/apache/sling/extensions/webconsolesecurityprovider/internal/SlingWebConsoleSecurityProvider.java" class="external-link" rel="nofollow"><TT>SlingWebConsoleSecurityProvider</TT></A>. This implementation uses a JCR implementation to login to the repository and thus validate the credentials.</P>
        <DIV class="timestamp" style="margin-top: 30px; font-size: 80%; text-align: right;">
Last modified by fmeschbe on Sun Sep 25 13:10:56 EDT 2011
        </DIV>
        <DIV class="trademarkFooter">
Apache Felix, Felix, Apache, the Apache feather logo, and the Apache Felix project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
        </DIV>
    </DIV>
  </BODY>
</HTML>
