
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML>
  <HEAD>
    <TITLE>Apache Felix - 6.6. Installing additional features</TITLE>
    <LINK rel="stylesheet" href="http://felix.apache.org/site/media.data/site.css" type="text/css" media="all">
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </HEAD>
  <BODY>
    <DIV class="title"><DIV class="logo"><A href="http://felix.apache.org/site/index.html"><IMG border="0" alt="Apache Felix" src="http://felix.apache.org/site/media.data/logo.png"></A></DIV><DIV class="header"><A href="http://www.apache.org/"><IMG border="0" alt="Apache" src="http://felix.apache.org/site/media.data/apache.png"></A></DIV></DIV>
    <DIV class="menu">
<UL>
	<LI><A href="news.html" title="news">news</A></LI>
	<LI><A href="license.html" title="license">license</A></LI>
	<LI><A href="http://felix.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">downloads</A></LI>
	<LI><A href="documentation.html" title="documentation">documentation</A></LI>
	<LI><A href="mailinglists.html" title="mailinglists">mailing lists</A></LI>
	<LI><A href="contributing.html" title="Contributing">contributing</A></LI>
	<LI><A href="http://www.apache.org/" class="external-link" rel="nofollow">asf</A></LI>
	<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">sponsorship</A></LI>
	<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link" rel="nofollow">sponsors</A>
<!-- ApacheCon Ad -->
<IFRAME src="http://www.apache.org/ads/button.html" style="border-width:0; float: left" frameborder="0" scrolling="no" width="135" height="135"></IFRAME>
<P style="height: 100px">
<!-- ApacheCon Ad --></LI>
</UL>
    </DIV>
    <DIV class="main">
<STYLE type="text/css">/*<![CDATA[*/
table.ScrollbarTable  {border: none;padding: 3px;width: 100%;padding: 3px;margin: 0px;background-color: #f0f0f0}
table.ScrollbarTable td.ScrollbarPrevIcon {text-align: center;width: 16px;border: none;}
table.ScrollbarTable td.ScrollbarPrevName {text-align: left;border: none;}
table.ScrollbarTable td.ScrollbarParent {text-align: center;border: none;}
table.ScrollbarTable td.ScrollbarNextName {text-align: right;border: none;}
table.ScrollbarTable td.ScrollbarNextIcon {text-align: center;width: 16px;border: none;}

/*]]>*/</STYLE><DIV class="Scrollbar"><TABLE class="ScrollbarTable"><TR><TD class="ScrollbarPrevIcon"><A href="65-deploying-security-providers.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/back_16.gif" width="16" height="16"></A></TD><TD width="33%" class="ScrollbarPrevName"><A href="65-deploying-security-providers.html">6.5. Deploying security providers</A>&nbsp;</TD><TD width="33%" class="ScrollbarParent"><SUP><A href="6-advanced-uses.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/up_16.gif" width="8" height="8"></A></SUP><A href="6-advanced-uses.html">6. Advanced uses</A></TD><TD width="33%" class="ScrollbarNextName">&nbsp;<A href="67-configuring-failover-deployments.html">6.7. Configuring Failover Deployments</A></TD><TD class="ScrollbarNextIcon"><A href="67-configuring-failover-deployments.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/forwd_16.gif" width="16" height="16"></A></TD></TR></TABLE></DIV>
<P><A name="6.6.Installingadditionalfeatures-top"></A></P>

<DIV class="panelMacro"><TABLE class="warningMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="http://cwiki.apache.org/confluence/images/icons/emoticons/forbidden.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD><B>Outdated documentation</B><BR></TD></TR></TABLE></DIV>

<H1><A name="6.6.Installingadditionalfeatures-6.6.Installingadditionalfeatures"></A>6.6. Installing additional features</H1>

<P>This chapter will demonstrate how to add additional features from a remote maven repository to a default installation of Karaf.</P>

<DIV class="panelMacro"><TABLE class="infoMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="http://cwiki.apache.org/confluence/images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>Last updated January 13, 2009 using smx4knl 1.1.0-SNAPSHOT</TD></TR></TABLE></DIV>

<H2><A name="6.6.Installingadditionalfeatures-Addingadditionalmavenrepositories"></A>Adding additional maven repositories</H2>

<P>The following steps will add in the missing OPS4J and Apache Snapshot maven repositories.  <B>Note</B> - this has been fixed in the 1.1.0 release and can be skipped.</P>
<OL>
	<LI>Edit the following file -
<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>etc/org.ops4j.pax.url.mvn.cfg
</PRE>
</DIV></DIV></LI>
	<LI>Update <EM>org.ops4j.pax.url.mvn.repositories</EM> to include the OPS4J and Apache Snapshot repos -
<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>org.ops4j.pax.url.mvn.repositories=file:${user.home}/.m2/repository@snapshots,http://repo1.maven.org/maven2,http://repository.ops4j.org/maven2,http://people.apache.org/repo/m2-snapshot-repository@snapshots@noreleases
</PRE>
</DIV></DIV></LI>
</OL>


<H2><A name="6.6.Installingadditionalfeatures-Addingadditionalfeaturerepositories"></A>Adding additional feature repositories</H2>

<P>The following steps will add in the URLs for the ServiceMix NMR and Features locations.</P>
<OL>
	<LI>Start Karaf
<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>cd bin
./servicemix or servicemix.bat
</PRE>
</DIV></DIV></LI>
	<LI>Add the following feature install locations
<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>servicemix&gt; features/addUrl mvn:org.apache.servicemix.nmr/apache-servicemix-nmr/1.0.0-m4/xml/features
servicemix&gt; features/addUrl mvn:org.apache.servicemix.features/apache-servicemix/4.0-m2-SNAPSHOT/xml/features
</PRE>
</DIV></DIV></LI>
	<LI>Verify the feature URLs were added -
<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>servicemix&gt; features/listUrl
mvn:org.apache.servicemix.nmr/apache-servicemix-nmr/1.0.0-m4-SNAPSHOT/xml/features
mvn:org.apache.servicemix.kernel/apache-servicemix-kernel/1.1.0-SNAPSHOT/xml/features
mvn:org.apache.servicemix.features/apache-servicemix/4.0-m2-SNAPSHOT/xml/features
</PRE>
</DIV></DIV></LI>
</OL>


<H2><A name="6.6.Installingadditionalfeatures-Installinganewfeature%28web%29"></A>Installing a new feature (web)</H2>

<P>The following steps will install the &quot;web&quot; feature (support for deploying WAR files with Servlet and JSPs into a Jetty server) into your Karaf instance.</P>
<OL>
	<LI>List the available features -
<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>servicemix&gt; features/list
 State        Name
. . .
[SMX4KNL:uninstalled] web
. . .
</PRE>
</DIV></DIV></LI>
	<LI>Install the web feature (and the sub-features it requires) -
<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>servicemix&gt; features/install web
</PRE>
</DIV></DIV></LI>
	<LI>Verify the features were installed
<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>servicemix&gt; features/list
 State        Name
. . .
[SMX4KNL:installed  ] web-core
[SMX4KNL:installed  ] web
. . .
</PRE>
</DIV></DIV></LI>
	<LI>Verify the installed bundles were started
<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>servicemix&gt; osgi/list
START LEVEL 100
   ID   State         Level  Name
. . .
[SMX4KNL:  29] [SMX4KNL:Active     ] [SMX4KNL:   50] Apache ServiceMix Bundles: jetty-6.1.14 (6.1.14.SNAPSHOT)
[SMX4KNL:  30] [SMX4KNL:Active     ] [SMX4KNL:   50] OPS4J Pax Web - Web Container (0.4.1)
[SMX4KNL:  31] [SMX4KNL:Active     ] [SMX4KNL:   50] OPS4J Pax Web - Jsp Support (0.4.1)
[SMX4KNL:  32] [SMX4KNL:Active     ] [SMX4KNL:   50] OPS4J Pax Web Extender - WAR (0.3.0)
[SMX4KNL:  33] [SMX4KNL:Active     ] [SMX4KNL:   50] OPS4J Pax Web Extender - Whiteboard (0.3.0)
[SMX4KNL:  34] [SMX4KNL:Active     ] [SMX4KNL:   50] OPS4J Pax Url - war:, war-i: (0.3.2)
[SMX4KNL:  35] [SMX4KNL:Active     ] [SMX4KNL:   50] Apache ServiceMix WAR Deployer (4.0.0.m2-SNAPSHOT)
. . .
</PRE>
</DIV></DIV></LI>
	<LI>The Jetty server should now be listening on <A href="http://localhost:8080/" class="external-link" rel="nofollow">http://localhost:8080/</A>, but with no published applications available.
<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>HTTP ERROR: 404
NOT_FOUND
RequestURI=/
Powered by jetty://
</PRE>
</DIV></DIV></LI>
</OL>


<H2><A name="6.6.Installingadditionalfeatures-DeployingaWARtotheinstalledwebfeature"></A>Deploying a WAR to the installed web feature</H2>

<P>The following steps will describe how to install a simple WAR file (with JSPs or Servlets) to the just installed web feature.</P>
<OL>
	<LI>To deploy a WAR (JSP or Servlet) to Jetty, update its MANIFEST.MF to include the required OSGi headers as described here - <BR class="atl-forced-newline">
<A href="http://wiki.ops4j.org/confluence/display/ops4j/Pax%20Web%20Extender%20-%20War%20-%20OSGi-fy" class="external-link" rel="nofollow">http://wiki.ops4j.org/confluence/display/ops4j/Pax+Web+Extender+-+War+-+OSGi-fy</A></LI>
	<LI>Copy the updated WAR (archive or extracted files) to the <EM>deploy</EM> directory.</LI>
</OL>


<P><A href="#6.6.Installingadditionalfeatures-top">top</A></P>
<STYLE type="text/css">/*<![CDATA[*/
table.ScrollbarTable  {border: none;padding: 3px;width: 100%;padding: 3px;margin: 0px;background-color: #f0f0f0}
table.ScrollbarTable td.ScrollbarPrevIcon {text-align: center;width: 16px;border: none;}
table.ScrollbarTable td.ScrollbarPrevName {text-align: left;border: none;}
table.ScrollbarTable td.ScrollbarParent {text-align: center;border: none;}
table.ScrollbarTable td.ScrollbarNextName {text-align: right;border: none;}
table.ScrollbarTable td.ScrollbarNextIcon {text-align: center;width: 16px;border: none;}

/*]]>*/</STYLE><DIV class="Scrollbar"><TABLE class="ScrollbarTable"><TR><TD class="ScrollbarPrevIcon"><A href="65-deploying-security-providers.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/back_16.gif" width="16" height="16"></A></TD><TD width="33%" class="ScrollbarPrevName"><A href="65-deploying-security-providers.html">6.5. Deploying security providers</A>&nbsp;</TD><TD width="33%" class="ScrollbarParent"><SUP><A href="6-advanced-uses.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/up_16.gif" width="8" height="8"></A></SUP><A href="6-advanced-uses.html">6. Advanced uses</A></TD><TD width="33%" class="ScrollbarNextName">&nbsp;<A href="67-configuring-failover-deployments.html">6.7. Configuring Failover Deployments</A></TD><TD class="ScrollbarNextIcon"><A href="67-configuring-failover-deployments.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/forwd_16.gif" width="16" height="16"></A></TD></TR></TABLE></DIV>
    </DIV>
  </BODY>
</HTML>
