
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML>
  <HEAD>
    <TITLE>Apache Felix - Apache Felix Framework and Alternative Java VMs</TITLE>
    <LINK rel="stylesheet" href="http://felix.apache.org/site/media.data/site.css" type="text/css" media="all">
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </HEAD>
  <BODY>
    <DIV class="title"><DIV class="logo"><A href="http://felix.apache.org/site/index.html"><IMG border="0" alt="Apache Felix" src="http://felix.apache.org/site/media.data/logo.png"></A></DIV><DIV class="header"><A href="http://www.apache.org/"><IMG border="0" alt="Apache" src="http://felix.apache.org/site/media.data/apache.png"></A></DIV></DIV>
    <DIV class="menu">
<UL>
	<LI><A href="news.html" title="news">news</A></LI>
	<LI><A href="http://www.apache.org/licenses/" class="external-link" rel="nofollow">license</A></LI>
	<LI><A href="http://felix.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">downloads</A></LI>
	<LI><A href="documentation.html" title="documentation">documentation</A></LI>
	<LI><A href="mailinglists.html" title="mailinglists">mailing lists</A></LI>
	<LI><A href="contributing.html" title="Contributing">contributing</A></LI>
	<LI><A href="http://www.apache.org/" class="external-link" rel="nofollow">asf</A></LI>
	<LI><A href="http://www.apache.org/security/" class="external-link" rel="nofollow">security</A></LI>
	<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">sponsorship</A></LI>
	<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link" rel="nofollow">sponsors</A>
<!-- ApacheCon Ad -->
<IFRAME src="http://www.apache.org/ads/button.html" style="border-width:0; float: left" frameborder="0" scrolling="no" width="135" height="135"></IFRAME>
<P style="height: 100px">
<!-- ApacheCon Ad --></LI>
</UL>
    </DIV>
    <DIV class="main">
<H1><A name="ApacheFelixFrameworkandAlternativeJavaVMs-ApacheFelixFrameworkandAlternativeJavaVMs"></A>Apache Felix Framework and Alternative Java VMs</H1>

<P>This page is intended to document experiences of running Felix on alternative Java VMs. Currently, the following VMs are included:</P>

<UL>
	<LI><A href="#ApacheFelixFrameworkandAlternativeJavaVMs-mika">Mika Java Virtual Machine</A></LI>
</UL>


<P>If you have an experience you would like to contribute or edits/additions to an existing platform, please contribute it.</P>

<P><A name="ApacheFelixFrameworkandAlternativeJavaVMs-mika"></A></P>

<H2><A name="ApacheFelixFrameworkandAlternativeJavaVMs-MikaJavaVirtualMachine"></A>Mika Java Virtual Machine</H2>

<P>Contributed by <A href="http://www.visnet.ch/smartbuildings/running-apache-felix-on-the-unc90-platform/" class="external-link" rel="nofollow">David Lindel&ouml;f</A>.</P>

<P>We have made Apache Felix run successfully on the <A href="http://softgun.sourceforge.net/unc90.shtml" class="external-link" rel="nofollow">UNC90</A> embedded platform and here I'd like to share our experience.</P>

<P>Our UNC90 runs on an ARM9 chip with 16 Mb flash and 32 Mb RAM. It runs the <A href="http://uclinux.org/" class="external-link" rel="nofollow">uClinux</A> operating system. The flash is divided in four partitions according to the <TT>linux/drivers/mtd/maps/modarm9.c</TT> file in uClinux's source distribution:</P>

<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>/dev/mtdblock/1: 256 kB for the U-Boot loader
/dev/mtdblock/2: 2.75 MB for the uClinux kernel
/dev/mtdblock/3: ~3 MB for the root partition
/dev/mtdblock/4: ~6.4 MB for user applications, mounted on /mnt
</PRE>
</DIV></DIV>

<P>We have chosen the Mika Java Virtual Machine, made by <A href="http://k-embedded-java.com/" class="external-link" rel="nofollow">/k/ Embedded Java Solutions</A>. We install it under <TT>/usr/bin</TT> and <TT>/usr/lib</TT> respectively, and its total footprint is about 1.67 MB. It claims to be compatible with at least Java 1.3, but already includes many features from Java 1.4.</P>

<P>We have installed Felix on the user applications partition under <TT>/mnt/felix</TT>. The framework is then started by a script similar to this:</P>

<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>mika 
    -Dfelix.config.properties=file:felix.config.properties 
    -Djava.protocol.handler.pkgs=wonka.net 
    -jar bin/felix.jar
</PRE>
</DIV></DIV>

<P>We had to slightly modify the default configuration file. We force the framework to export system packages as if we were running Java 1.4:</P>

<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>org.osgi.framework.system.packages=org.osgi.framework; version=1.3.0, 
 org.osgi.service.packageadmin; version=1.2.0, 
 org.osgi.service.startlevel; version=1.0.0, 
 org.osgi.service.url; version=1.0.0, 
 ${jre-1.4}
# ${jre-${java.specification.version}}
</PRE>
</DIV></DIV>

<P>The <TT>-Djava.protocol.handler.pkgs=wonka.net</TT> option is necessary if you want to do anything URL-related. See <A href="http://felix.apache.org/site/faq.html" class="external-link" rel="nofollow">here</A> for a full discussion. Basically, we must specify the name of a package containing protocol handlers, which defaults to <TT>sun.net.www.protocol</TT>. But with Mika this must be set to <TT>wonka.net</TT> (use <TT>com.acunia.wonka.net</TT> on older versions of Mika).</P>

<P>We have found this setup to be more than satisfactory in terms of stability, performance and memory usage. We have uncovered several bugs in Mika's class library, but the folks at /k/ have always patched them in a timely manner.</P>

<H2><A name="ApacheFelixFrameworkandAlternativeJavaVMs-Feedback"></A>Feedback</H2>

<P>Subscribe to the Felix users mailing list by sending a message to <A href="mailto:users-subscribe@felix.apache.org" class="external-link" rel="nofollow">users-subscribe@felix.apache.org</A>; after subscribing, email questions or feedback to <A href="mailto:users@felix.apache.org" class="external-link" rel="nofollow">users@felix.apache.org</A>.</P>
        <DIV class="timestamp" style="margin-top: 30px; font-size: 80%; text-align: right;">
Last modified by heavy@ungoverned.org on 2009-05-05 08:53:49.0
        </DIV>
        <DIV class="trademarkFooter">
Apache Felix, Felix, Apache, the Apache feather logo, and the Apache Felix project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
        </DIV>
    </DIV>
  </BODY>
</HTML>
