
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML>
  <HEAD>
    <TITLE>Apache Felix - 4.4. Deployer</TITLE>
    <LINK rel="stylesheet" href="http://felix.apache.org/site/media.data/site.css" type="text/css" media="all">
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </HEAD>
  <BODY>
    <DIV class="title"><DIV class="logo"><A href="http://felix.apache.org/site/index.html"><IMG border="0" alt="Apache Felix" src="http://felix.apache.org/site/media.data/logo.png"></A></DIV><DIV class="header"><A href="http://www.apache.org/"><IMG border="0" alt="Apache" src="http://felix.apache.org/site/media.data/apache.png"></A></DIV></DIV>
    <DIV class="menu">
<UL>
	<LI><A href="news.html" title="news">news</A></LI>
	<LI><A href="license.html" title="license">license</A></LI>
	<LI><A href="http://felix.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">downloads</A></LI>
	<LI><A href="documentation.html" title="documentation">documentation</A></LI>
	<LI><A href="mailinglists.html" title="mailinglists">mailing lists</A></LI>
	<LI><A href="contributing.html" title="Contributing">contributing</A></LI>
	<LI><A href="http://www.apache.org/" class="external-link" rel="nofollow">asf</A></LI>
	<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">sponsorship</A></LI>
	<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link" rel="nofollow">sponsors</A>
<!-- ApacheCon Ad -->
<IFRAME src="http://www.apache.org/ads/button.html" style="border-width:0; float: left" frameborder="0" scrolling="no" width="135" height="135"></IFRAME>
<P style="height: 100px">
<!-- ApacheCon Ad --></LI>
</UL>
    </DIV>
    <DIV class="main">
<STYLE type="text/css">/*<![CDATA[*/
table.ScrollbarTable  {border: none;padding: 3px;width: 100%;padding: 3px;margin: 0px;background-color: #f0f0f0}
table.ScrollbarTable td.ScrollbarPrevIcon {text-align: center;width: 16px;border: none;}
table.ScrollbarTable td.ScrollbarPrevName {text-align: left;border: none;}
table.ScrollbarTable td.ScrollbarParent {text-align: center;border: none;}
table.ScrollbarTable td.ScrollbarNextName {text-align: right;border: none;}
table.ScrollbarTable td.ScrollbarNextIcon {text-align: center;width: 16px;border: none;}

/*]]>*/</STYLE><DIV class="Scrollbar"><TABLE class="ScrollbarTable"><TR><TD class="ScrollbarPrevIcon"><A href="43-logging-system.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/back_16.gif" width="16" height="16"></A></TD><TD width="33%" class="ScrollbarPrevName"><A href="43-logging-system.html">4.3. Logging system</A>&nbsp;</TD><TD width="33%" class="ScrollbarParent"><SUP><A href="4-understanding-karaf.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/up_16.gif" width="8" height="8"></A></SUP><A href="4-understanding-karaf.html">4. Understanding Karaf</A></TD><TD width="33%" class="ScrollbarNextName">&nbsp;<A href="45-security-framework.html">4.5. Security framework</A></TD><TD class="ScrollbarNextIcon"><A href="45-security-framework.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/forwd_16.gif" width="16" height="16"></A></TD></TR></TABLE></DIV>
<P><A name="4.4.Deployer-top"></A></P>

<H1><A name="4.4.Deployer-4.4.Deployer"></A>4.4. Deployer</H1>

<P>The following picture describes the architecture of the deployer.</P>

<P><SPAN class="image-wrap" style=""><IMG src="44-deployer.data/smx4-deployer.png" style="border: 0px solid black"></SPAN></P>

<H2><A name="4.4.Deployer-Springdeployer"></A>Spring deployer</H2>

<P>Karaf includes a deployer that is able to deploy plain spring / spring-dm configuration files.<BR>
The deployer will transform on the fly any spring configuration file dropped into the <TT>deploy</TT> folder into a valid OSGi bundle.</P>

<P>The generated OSGi manifest will contain the following headers:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
Manifest-Version: 2
Bundle-SymbolicName: [name of the file]
Bundle-Version: [version of the file]
Spring-Context: *;publish-context:=<SPAN class="code-keyword">false</SPAN>;create-asynchronously:=<SPAN class="code-keyword">true</SPAN>
Import-Package: [required packages]
DynamicImport-Package: *
</PRE>
</DIV></DIV>

<P>The <TT>name</TT> and <TT>version</TT> of the file are extracted using a heuristic that will match common patterns.  For example <TT>my-config-1.0.1.xml</TT> will lead to <TT>name = my-config</TT> and <TT>version = 1.0.1</TT>.<BR>
The default imported packages are extracted from the spring file definition and includes all classes referenced directly.</P>

<P>If you need to customize the generated manifest, you can do so by including an xml element in your spring configuration:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
<SPAN class="code-tag">&lt;spring:beans ...&gt;</SPAN>
  <SPAN class="code-tag">&lt;manifest&gt;</SPAN>
    Require-Bundle= my-bundle
  <SPAN class="code-tag">&lt;/manifest&gt;</SPAN>
</PRE>
</DIV></DIV>

<H2><A name="4.4.Deployer-Featuresdeployer"></A>Features deployer</H2>

<P>To be able to hot deploy features from the deploy folder, you can just drop a feature descriptor on that folder.  A bundle will be created and its installation (automatic) will trigger the installation of all features contained in the descriptor.  Removing the file from the deploy folder will uninstall the features.<BR>
If you want to install a single feature, you can do so by writing a feature descriptor like the following:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-xml">
<SPAN class="code-tag">&lt;features&gt;</SPAN>
  <SPAN class="code-tag">&lt;repository&gt;</SPAN>mvn:org.apache.servicemix.nmr/apache-servicemix-nmr/1.0.0/xml/features<SPAN class="code-tag">&lt;/repository&gt;</SPAN>
  <SPAN class="code-tag">&lt;feature name=<SPAN class="code-quote">&quot;nmr-only&quot;</SPAN>&gt;</SPAN>
    <SPAN class="code-tag">&lt;feature&gt;</SPAN>nmr<SPAN class="code-tag">&lt;/feature&gt;</SPAN>
  <SPAN class="code-tag">&lt;/feature&gt;</SPAN>
<SPAN class="code-tag">&lt;/features&gt;</SPAN>
</PRE>
</DIV></DIV>

<P>For more informations about features, see the <A href="46-provisioning.html" title="4.6. Provisioning">provisioning section</A>.</P>

<P><A href="#4.4.Deployer-top">top</A></P>
<STYLE type="text/css">/*<![CDATA[*/
table.ScrollbarTable  {border: none;padding: 3px;width: 100%;padding: 3px;margin: 0px;background-color: #f0f0f0}
table.ScrollbarTable td.ScrollbarPrevIcon {text-align: center;width: 16px;border: none;}
table.ScrollbarTable td.ScrollbarPrevName {text-align: left;border: none;}
table.ScrollbarTable td.ScrollbarParent {text-align: center;border: none;}
table.ScrollbarTable td.ScrollbarNextName {text-align: right;border: none;}
table.ScrollbarTable td.ScrollbarNextIcon {text-align: center;width: 16px;border: none;}

/*]]>*/</STYLE><DIV class="Scrollbar"><TABLE class="ScrollbarTable"><TR><TD class="ScrollbarPrevIcon"><A href="43-logging-system.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/back_16.gif" width="16" height="16"></A></TD><TD width="33%" class="ScrollbarPrevName"><A href="43-logging-system.html">4.3. Logging system</A>&nbsp;</TD><TD width="33%" class="ScrollbarParent"><SUP><A href="4-understanding-karaf.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/up_16.gif" width="8" height="8"></A></SUP><A href="4-understanding-karaf.html">4. Understanding Karaf</A></TD><TD width="33%" class="ScrollbarNextName">&nbsp;<A href="45-security-framework.html">4.5. Security framework</A></TD><TD class="ScrollbarNextIcon"><A href="45-security-framework.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/forwd_16.gif" width="16" height="16"></A></TD></TR></TABLE></DIV>
    </DIV>
  </BODY>
</HTML>
