
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML>
  <HEAD>
    <TITLE>Apache Felix - 4.2. Remote Console</TITLE>
    <LINK rel="stylesheet" href="http://felix.apache.org/site/media.data/site.css" type="text/css" media="all">
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </HEAD>
  <BODY>
    <DIV class="title"><DIV class="logo"><A href="http://felix.apache.org/site/index.html"><IMG border="0" alt="Apache Felix" src="http://felix.apache.org/site/media.data/logo.png"></A></DIV><DIV class="header"><A href="http://www.apache.org/"><IMG border="0" alt="Apache" src="http://felix.apache.org/site/media.data/apache.png"></A></DIV></DIV>
    <DIV class="menu">
<UL>
	<LI><A href="news.html" title="news">news</A></LI>
	<LI><A href="license.html" title="license">license</A></LI>
	<LI><A href="http://felix.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">downloads</A></LI>
	<LI><A href="documentation.html" title="documentation">documentation</A></LI>
	<LI><A href="mailinglists.html" title="mailinglists">mailing lists</A></LI>
	<LI><A href="contributing.html" title="Contributing">contributing</A></LI>
	<LI><A href="http://www.apache.org/" class="external-link" rel="nofollow">asf</A></LI>
	<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">sponsorship</A></LI>
	<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link" rel="nofollow">sponsors</A>
<!-- ApacheCon Ad -->
<IFRAME src="http://www.apache.org/ads/button.html" style="border-width:0; float: left" frameborder="0" scrolling="no" width="135" height="135"></IFRAME>
<P style="height: 100px">
<!-- ApacheCon Ad --></LI>
</UL>
    </DIV>
    <DIV class="main">
<STYLE type="text/css">/*<![CDATA[*/
table.ScrollbarTable  {border: none;padding: 3px;width: 100%;padding: 3px;margin: 0px;background-color: #f0f0f0}
table.ScrollbarTable td.ScrollbarPrevIcon {text-align: center;width: 16px;border: none;}
table.ScrollbarTable td.ScrollbarPrevName {text-align: left;border: none;}
table.ScrollbarTable td.ScrollbarParent {text-align: center;border: none;}
table.ScrollbarTable td.ScrollbarNextName {text-align: right;border: none;}
table.ScrollbarTable td.ScrollbarNextIcon {text-align: center;width: 16px;border: none;}

/*]]>*/</STYLE><DIV class="Scrollbar"><TABLE class="ScrollbarTable"><TR><TD class="ScrollbarPrevIcon"><A href="41-console-and-commands.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/back_16.gif" width="16" height="16"></A></TD><TD width="33%" class="ScrollbarPrevName"><A href="41-console-and-commands.html">4.1. Console and Commands</A>&nbsp;</TD><TD width="33%" class="ScrollbarParent"><SUP><A href="4-understanding-karaf.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/up_16.gif" width="8" height="8"></A></SUP><A href="4-understanding-karaf.html">4. Understanding Karaf</A></TD><TD width="33%" class="ScrollbarNextName">&nbsp;<A href="43-logging-system.html">4.3. Logging system</A></TD><TD class="ScrollbarNextIcon"><A href="43-logging-system.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/forwd_16.gif" width="16" height="16"></A></TD></TR></TABLE></DIV>
<P><A name="4.2.RemoteConsole-top"></A></P>

<H1><A name="4.2.RemoteConsole-4.2.RemoteConsole"></A>4.2. Remote Console</H1>

<P>The remote console feature allows to connect to a running Karaf instance from a remote computer and perform all the operations that are usually accessible from the local console.</P>

<H2><A name="4.2.RemoteConsole-Launchoptions"></A>Launch options</H2>

<P>The Karaf shell scripts supports a number of options to control the remote console:</P>
<UL>
	<LI><B><TT>console</TT></B>: launch Karaf in the default mode (both local and remote console activated).  This is the default mode</LI>
	<LI><B><TT>server</TT></B>: launch Karaf in with a remote console but no local console</LI>
	<LI><B><TT>client</TT></B>: launch Karaf in with a local console only</LI>
</UL>


<P>These options affect two system properties that can be set if you don't use the standard shell scripts:</P>
<UL>
	<LI><TT>karaf.startLocalConsole</TT></LI>
	<LI><TT>karaf.startRemoteShell</TT></LI>
</UL>


<H2><A name="4.2.RemoteConsole-Usingtheclientjar"></A>Using the client jar</H2>

<P>It is also possible to use a more lightweight way to connect to a Karaf instance using the following command line:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
java -jar lib/karaf-client.jar
</PRE>
</DIV></DIV>

<P>There are a few parameters that can be set on the command line to change the URL used to connect to the Kernel, the user or the password.<BR>
All these parameters are detailed in the help screen:</P>

<DIV class="code panel" style="border-style: solid;border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
&gt; java -jar lib/karaf-client.jar --help
Apache Felix Karaf client
  -a [address]  specify the URL to connect to
  -h [host]     specify the host to connect to
  -u [user]     specify the user name
  -p [password] specify the password
  --help        shows <SPAN class="code-keyword">this</SPAN> help message
  [commands]    commands to run
If no commands are specified, the client will be put in an interactive mode
</PRE>
</DIV></DIV>

<P>For example, to shut down the Kernel from the command line, you can run the following command:</P>

<DIV class="code panel" style="border-style: solid;border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
&gt; java -jar lib/karaf-client.jar 
smx@root:/&gt; osgi:shutdown
smx@root:/&gt;
&gt;
</PRE>
</DIV></DIV>

<P>The client jar also supports passing command line arguments to the remote Karaf.</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
&gt; java -jar lib/karaf-client.jar osgi:shutdown
&gt;
</PRE>
</DIV></DIV>

<P><A href="#4.2.RemoteConsole-top">top</A></P>

<H2><A name="4.2.RemoteConsole-UsinganSSHclient"></A>Using an SSH client</H2>

<P>You can use any standard SSH client to connect to a Karaf instance.  The default port is 8101.</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
&gt; ssh -p 8101 -l karaf localhost
karaf@localhost's password: karaf
karaf@root:/&gt;
</PRE>
</DIV></DIV>

<P><A href="#4.2.RemoteConsole-top">top</A></P>

<H2><A name="4.2.RemoteConsole-UsinganotherKarafinstance"></A>Using another Karaf instance</H2>

<P>First, open a terminal and launch Karaf in server mode (you could use a Karaf instance in console mode too):</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
bin/karaf server
</PRE>
</DIV></DIV>

<P>On another terminal, start another Karaf instance in client mode:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
bin/karaf client
</PRE>
</DIV></DIV>

<DIV class="panelMacro"><TABLE class="tipMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="http://cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD><B>User another Karaf instance to start the client</B><BR>At this point in time, you can not use the same Karaf installation to start both the server and the client, so you need to create a new instance using the 'admin create xxx' command and use that one to start the client.  If you are on a different host or already use another copy of Karaf, this requirement does not hold.</TD></TR></TABLE></DIV>

<P>Once the console appears, you can run the <TT>remote rsh</TT> command to connect to the other Kernel:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
remote rsh tcp:<SPAN class="code-comment">//localhost:8101/ -u karaf -p karaf </SPAN>
</PRE>
</DIV></DIV>

<P>You can also do that in a single command line from the prompt by appending the previous ServiceMix command to the shell command:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
bin/karaf client remote rsh tcp:<SPAN class="code-comment">//localhost:8101/ -u karaf -p karaf </SPAN>
</PRE>
</DIV></DIV>

<P>To verify that your are connected to the remote instance, run the following command:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
info
</PRE>
</DIV></DIV>
<P>and check the system informations.</P>

<H3><A name="4.2.RemoteConsole-Configuration"></A>Configuration</H3>

<P>The TCP port is configured at the following location:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
[KARAF]/etc/org.apache.felix.karaf.shell.cfg
</PRE>
</DIV></DIV>

<P>The defaut configuration is as below:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
startLocalConsole=${karaf.startLocalConsole}
startRemoteShell=${karaf.startRemoteShell}
sshPort=8101
sshRealm=karaf
hostKey=${karaf.base}/etc/host.key
</PRE>
</DIV></DIV>

<P>The port used can easily be changed by changing the default port <TT>8101</TT> in the <TT>sshPort</TT> property.</P>

<P>The security realm used by the console when authenticating remote users is named <TT>karaf</TT>, so you can override this realm as explained in the <A href="45-security-framework.html" title="4.5. Security framework">security section</A>.  </P>

<P><A href="#4.2.RemoteConsole-top">top</A></P>
<STYLE type="text/css">/*<![CDATA[*/
table.ScrollbarTable  {border: none;padding: 3px;width: 100%;padding: 3px;margin: 0px;background-color: #f0f0f0}
table.ScrollbarTable td.ScrollbarPrevIcon {text-align: center;width: 16px;border: none;}
table.ScrollbarTable td.ScrollbarPrevName {text-align: left;border: none;}
table.ScrollbarTable td.ScrollbarParent {text-align: center;border: none;}
table.ScrollbarTable td.ScrollbarNextName {text-align: right;border: none;}
table.ScrollbarTable td.ScrollbarNextIcon {text-align: center;width: 16px;border: none;}

/*]]>*/</STYLE><DIV class="Scrollbar"><TABLE class="ScrollbarTable"><TR><TD class="ScrollbarPrevIcon"><A href="41-console-and-commands.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/back_16.gif" width="16" height="16"></A></TD><TD width="33%" class="ScrollbarPrevName"><A href="41-console-and-commands.html">4.1. Console and Commands</A>&nbsp;</TD><TD width="33%" class="ScrollbarParent"><SUP><A href="4-understanding-karaf.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/up_16.gif" width="8" height="8"></A></SUP><A href="4-understanding-karaf.html">4. Understanding Karaf</A></TD><TD width="33%" class="ScrollbarNextName">&nbsp;<A href="43-logging-system.html">4.3. Logging system</A></TD><TD class="ScrollbarNextIcon"><A href="43-logging-system.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/forwd_16.gif" width="16" height="16"></A></TD></TR></TABLE></DIV>

    </DIV>
  </BODY>
</HTML>
