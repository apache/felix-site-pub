
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML>
  <HEAD>
    <TITLE>Apache Felix - 2.1. Quick Start (Source)</TITLE>
    <LINK rel="stylesheet" href="http://felix.apache.org/site/media.data/site.css" type="text/css" media="all">
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </HEAD>
  <BODY>
    <DIV class="title"><DIV class="logo"><A href="http://felix.apache.org/site/index.html"><IMG border="0" alt="Apache Felix" src="http://felix.apache.org/site/media.data/logo.png"></A></DIV><DIV class="header"><A href="http://www.apache.org/"><IMG border="0" alt="Apache" src="http://felix.apache.org/site/media.data/apache.png"></A></DIV></DIV>
    <DIV class="menu">
<UL>
	<LI><A href="news.html" title="news">news</A></LI>
	<LI><A href="license.html" title="license">license</A></LI>
	<LI><A href="http://felix.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">downloads</A></LI>
	<LI><A href="documentation.html" title="documentation">documentation</A></LI>
	<LI><A href="mailinglists.html" title="mailinglists">mailing lists</A></LI>
	<LI><A href="contributing.html" title="Contributing">contributing</A></LI>
	<LI><A href="http://www.apache.org/" class="external-link" rel="nofollow">asf</A></LI>
	<LI><A href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">sponsorship</A></LI>
	<LI><A href="http://www.apache.org/foundation/thanks.html" class="external-link" rel="nofollow">sponsors</A>
<!-- ApacheCon Ad -->
<IFRAME src="http://www.apache.org/ads/button.html" style="border-width:0; float: left" frameborder="0" scrolling="no" width="135" height="135"></IFRAME>
<P style="height: 100px">
<!-- ApacheCon Ad --></LI>
</UL>
    </DIV>
    <DIV class="main">
<STYLE type="text/css">/*<![CDATA[*/
table.ScrollbarTable  {border: none;padding: 3px;width: 100%;padding: 3px;margin: 0px;background-color: #f0f0f0}
table.ScrollbarTable td.ScrollbarPrevIcon {text-align: center;width: 16px;border: none;}
table.ScrollbarTable td.ScrollbarPrevName {text-align: left;border: none;}
table.ScrollbarTable td.ScrollbarParent {text-align: center;border: none;}
table.ScrollbarTable td.ScrollbarNextName {text-align: right;border: none;}
table.ScrollbarTable td.ScrollbarNextIcon {text-align: center;width: 16px;border: none;}

/*]]>*/</STYLE><DIV class="Scrollbar"><TABLE class="ScrollbarTable"><TR><TD width="33%" class="ScrollbarPrevName">&nbsp;</TD><TD width="33%" class="ScrollbarParent"><SUP><A href="2-quick-start.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/up_16.gif" width="8" height="8"></A></SUP><A href="2-quick-start.html">2. Quick Start</A></TD><TD width="33%" class="ScrollbarNextName">&nbsp;</TD></TR></TABLE></DIV>
<P><A name="2.1.QuickStart%28Source%29-top"></A></P>

<H1><A name="2.1.QuickStart%28Source%29-2.1.QuickStart%28Source%29"></A>2.1. Quick Start (Source)</H1>

<P>If you are in a hurry to have Apache Felix Karaf up and running right away, this section will provide you with some basic steps for checking out, building and running the server in no time. This is clearly not a complete guide so you may want to check other sections of this guide for further information.</P>

<P>All you need is 15 minutes and to follow these basic steps.</P>
<UL>
	<LI><A href="#2.1.QuickStart%2528Source%2529-Background">Background</A></LI>
	<LI><A href="#2.1.QuickStart%2528Source%2529-Gettingthesoftware">Getting the software</A></LI>
	<LI><A href="#2.1.QuickStart%2528Source%2529-Starttheserver">Start the server</A></LI>
	<LI><A href="#2.1.QuickStart%2528Source%2529-Deployasampleapplication">Deploy a sample application</A></LI>
</UL>


<H2><A name="2.1.QuickStart%28Source%29-Background"></A>Background</H2>

<P>Apache Felix Karaf is a small and lightweight OSGi based runtime.  This provides a small lightweight container onto which various bundles can be deployed.</P>
<DIV class="panelMacro"><TABLE class="tipMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="http://cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>Apache Felix Karaf started life as the <A href="http://servicemix.apache.org/" class="external-link" rel="nofollow">Apache ServiceMix </A> kernel.<BR>
Don't be surprised by any transitional references which remain.</TD></TR></TABLE></DIV>
<P><A href="#2.1.QuickStart%2528Source%2529-top">top</A></P>

<H2><A name="2.1.QuickStart%28Source%29-Gettingthesoftware"></A>Getting the software</H2>

<P>This document describes how to build the server from the latest Karaf source. </P>

<H3><A name="2.1.QuickStart%28Source%29-Prerequisites"></A>Prerequisites</H3>

<P>Although this installation path is the fastest one, still you will need to install some software before installing Karaf.</P>

<P>Karaf requires a Java 5 environment to run. Refer to <A href="http://java.sun.com/" class="external-link" rel="nofollow">http://java.sun.com</A> for details on how to download and install J2SE 1.5 or greater.</P>

<P><A href="http://subversion.tigris.org/" class="external-link" rel="nofollow">Subversion </A> is required to checkout the source.</P>

<P><A href="http://maven.apache.org/" class="external-link" rel="nofollow">Maven 2</A> is required to build Karaf.</P>

<H3><A name="2.1.QuickStart%28Source%29-CheckoutSource"></A>Checkout Source</H3>

<P>The Karaf source is found at <A href="http://svn.apache.org/repos/asf/felix/trunk/karaf/" class="external-link" rel="nofollow">http://svn.apache.org/repos/asf/felix/trunk/karaf/</A>. To check out with a command line client:</P>

<DIV class="code panel" style="border-style: solid;border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
$ svn co http:<SPAN class="code-comment">//svn.apache.org/repos/asf/felix/trunk/karaf/</SPAN>
</PRE>
</DIV></DIV> 

<H3><A name="2.1.QuickStart%28Source%29-Build"></A>Build</H3>

<P>Change directory to the top level of the source checkout. Build Karaf using Maven as follows:</P>

<DIV class="code panel" style="border-style: solid;border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
$ mvn -Pfastinstall
</PRE>
</DIV></DIV>

<P>Distributions will be created in assembly/target. Select the file compression format compatible with your system (apache-felix-karaf-1.0.0.zip for windows, apache-felix-karaf-1.0.0.tar.gz for unixes) and expand the binary in a new directory; for example in z:\karaf - from now on this directory will be referenced as &lt;KARAF_HOME&gt;. Please remember the restrictions concerning illegal characters in Java paths, e.g. &#33;, % etc.</P>

<P>The installation of Karaf is as simple as uncompressing the .zip or .tar files. The next step is to start the server.</P>

<DIV class="panelMacro"><TABLE class="tipMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="http://cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>To generate Eclipse projects for all modules, in KARAF_HOME type:

<P>mvn -Psetup.eclipse </P>

<P>Then add each module location, prefixing each name with <EM>org.apache.felix.karaf</EM> (for example <EM>org.apache.felix.karaf.shell.core</EM>)</P></TD></TR></TABLE></DIV>

<P><A href="#2.1.QuickStart%2528Source%2529-top">top</A></P>

<H2><A name="2.1.QuickStart%28Source%29-Starttheserver"></A>Start the server</H2>

<P>With Karaf already installed, open a command line console and change directory to &lt;KARAF_HOME&gt;. To start the server, run the following command in Windows:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
bin\karaf.bat
</PRE>
</DIV></DIV>
<P>respectively on Unix:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
bin/karaf
</PRE>
</DIV></DIV>
<P>You should see the following informations on the command line console:</P>
<DIV class="code panel" style="border-style: solid;border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
        __ __                  ____      
       / <SPAN class="code-comment">//_/____ __________ _/ __/      
</SPAN>      / ,&lt;  / __ `/ ___/ __ `/ /_        
     / /| |/ /_/ / /  / /_/ / __/        
    /_/ |_|\__,_/_/   \__,_/_/         

  Apache Felix Karaf (1.0.0)

Hit '&lt;tab&gt;' <SPAN class="code-keyword">for</SPAN> a list of available commands
and '[cmd] --help' <SPAN class="code-keyword">for</SPAN> help on a specific command.

karaf@root&gt; 
</PRE>
</DIV></DIV>
<P>You can now run your first command.  Simply type the <TT>&lt;tab&gt;</TT> key in the console.</P>
<DIV class="code panel" style="border-style: solid;border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
karaf@root&gt; 

admin:change-port        admin:connect            admin:create             admin:destroy            admin:list               admin:start
admin:stop               config:cancel            config:edit              config:list              config:propappend        config:propdel
config:proplist          config:propset           config:update            features:addUrl          features:install         features:list
features:listUrl         features:refreshUrl      features:removeUrl       features:uninstall       log:display              log:display-exception
log:get                  log:set                  osgi:bundle-level        osgi:headers             osgi:install             osgi:list
osgi:ls                  osgi:refresh             osgi:resolve             osgi:restart             osgi:shutdown            osgi:start
osgi:start-level         osgi:stop                osgi:uninstall           osgi:update              packages:exports         packages:imports
shell:cat                shell:echo               shell:exec               shell:grep               shell:info               shell:java
shell:printf             shell:sleep              shell:sort               shell:tac                ssh:ssh                  ssh:sshd
karaf@root&gt; 
</PRE>
</DIV></DIV>
<P><A href="#2.1.QuickStart%2528Source%2529-top">top</A></P>

<H2><A name="2.1.QuickStart%28Source%29-Deployasampleapplication"></A>Deploy a sample application</H2>

<P>While you will learn in the remainder of this guide how to use and leverage Apache Felix Karaf, we will just use the pre-built packaging for now.</P>

<P>In the console, run the following commands:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
features:install spring-dm
osgi:install -s mvn:org.apache.geronimo.specs/geronimo-activation_1.1_spec/1.0.2
osgi:install -s mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.stax-api-1.0/1.1.0
osgi:install -s mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.jaxb-api-2.1/1.1.0
osgi:install -s mvn:org.apache.servicemix.bundles/org.apache.servicemix.bundles.jaxb-impl/2.1.6_1
osgi:install -s mvn:org.apache.camel/camel-core/1.4.0
osgi:install -s mvn:org.springframework/spring-tx/2.5.6.SEC01
osgi:install -s mvn:org.apache.camel/camel-spring/1.4.0
osgi:install -s mvn:org.apache.camel/camel-osgi/1.4.0
osgi:install -s mvn:org.apache.camel/camel-example-osgi/1.4.0
</PRE>
</DIV></DIV>
<P>This commands will download, install and start the specified jars.</P>

<P>The example installed is using <A href="http://activemq.apache.org/camel" class="external-link" rel="nofollow">Camel</A> to start a timer every 2 seconds and output a message on the console.</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
&gt;&gt;&gt;&gt; MyTransform set body:  Wed Jan 02 23:34:19 CET 2008
&gt;&gt;&gt;&gt; MyTransform set body:  Wed Jan 02 23:34:21 CET 2008
</PRE>
</DIV></DIV>

<H3><A name="2.1.QuickStart%28Source%29-Stoppinganduninstallingthesampleapplication"></A>Stopping and uninstalling the sample application</H3>

<P>To stop this demo, run the following command:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
osgi:list | grep example
</PRE>
</DIV></DIV>
<P>In the output, locate the line containing <TT>camel-example-osgi</TT> and note the id of the bundle in the first column.  Then launch the following command:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
osgi:stop [id]
</PRE>
</DIV></DIV>
<P>If you wish, you can start again the sample by using the following command:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
osgi:start [id]
</PRE>
</DIV></DIV>
<P>To uninstall the demo, run the following command:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
osgi:uninstall [id]
</PRE>
</DIV></DIV>

<H3><A name="2.1.QuickStart%28Source%29-CommonProblems"></A>Common Problems</H3>

<OL>
	<LI>Launching SMX4 can result in a deadlock in Felix during module dependency resolution.  This is often a result of sending a SIGINT (control-C) to the process when it will not cleanly exit.  This can corrupt the caches and cause startup problems in the very next launch. It is fixed by emptying the component cache:
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
rm -rf data/cache/*
</PRE>
</DIV></DIV></LI>
</OL>


<H2><A name="2.1.QuickStart%28Source%29-StoppingKaraf"></A>Stopping Karaf</H2>

<P>To stop Karaf from the console, enter <TT>^D</TT> in the console:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
^D
</PRE>
</DIV></DIV>
<P>Alternatively, you can also run the following command:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
osgi:shutdown
</PRE>
</DIV></DIV>

<H2><A name="2.1.QuickStart%28Source%29-Summary"></A>Summary</H2>

<P>This document showed you how simple it is to have Apache Felix Karaf up and running. The overall time for getting the server running should be less than five minutes if you have the prerequisite (Java 1.5) already installed. Additionally, this article also showed you how to deploy and test a simple Apache Camel application in less than five minutes.</P>

<P><A href="#2.1.QuickStart%2528Source%2529-top">top</A></P>
<STYLE type="text/css">/*<![CDATA[*/
table.ScrollbarTable  {border: none;padding: 3px;width: 100%;padding: 3px;margin: 0px;background-color: #f0f0f0}
table.ScrollbarTable td.ScrollbarPrevIcon {text-align: center;width: 16px;border: none;}
table.ScrollbarTable td.ScrollbarPrevName {text-align: left;border: none;}
table.ScrollbarTable td.ScrollbarParent {text-align: center;border: none;}
table.ScrollbarTable td.ScrollbarNextName {text-align: right;border: none;}
table.ScrollbarTable td.ScrollbarNextIcon {text-align: center;width: 16px;border: none;}

/*]]>*/</STYLE><DIV class="Scrollbar"><TABLE class="ScrollbarTable"><TR><TD width="33%" class="ScrollbarPrevName">&nbsp;</TD><TD width="33%" class="ScrollbarParent"><SUP><A href="2-quick-start.html"><IMG border="0" align="middle" src="http://cwiki.apache.org/confluence/images/icons/up_16.gif" width="8" height="8"></A></SUP><A href="2-quick-start.html">2. Quick Start</A></TD><TD width="33%" class="ScrollbarNextName">&nbsp;</TD></TR></TABLE></DIV>
    </DIV>
  </BODY>
</HTML>
